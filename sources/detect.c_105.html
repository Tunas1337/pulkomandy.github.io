
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>detect.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2"> * Copyright (c) 2002, Thomas Kurschel</a>
<a name="ln3"> * Distributed under the terms of the MIT license.</a>
<a name="ln4"> */</a>
<a name="ln5"> </a>
<a name="ln6">/**	Graphics card detection */</a>
<a name="ln7"> </a>
<a name="ln8"> </a>
<a name="ln9">#include &quot;radeon_driver.h&quot;</a>
<a name="ln10"> </a>
<a name="ln11">#include &lt;stdio.h&gt;</a>
<a name="ln12">#include &lt;string.h&gt;</a>
<a name="ln13"> </a>
<a name="ln14"> </a>
<a name="ln15">// this table is gathered from different sources</a>
<a name="ln16">// and may even contain some wrong entries</a>
<a name="ln17">#define VENDOR_ID_ATI		0x1002</a>
<a name="ln18"> </a>
<a name="ln19">// R100</a>
<a name="ln20">#define DEVICE_ID_RADEON_QD		0x5144</a>
<a name="ln21">#define DEVICE_ID_RADEON_QE		0x5145</a>
<a name="ln22">#define DEVICE_ID_RADEON_QF		0x5146</a>
<a name="ln23">#define DEVICE_ID_RADEON_QG		0x5147</a>
<a name="ln24"> </a>
<a name="ln25">// RV100</a>
<a name="ln26">#define DEVICE_ID_RADEON_QY		0x5159</a>
<a name="ln27">#define DEVICE_ID_RADEON_QZ		0x515a</a>
<a name="ln28"> </a>
<a name="ln29">#define DEVICE_ID_RN50_515E		0x515E</a>
<a name="ln30">#define DEVICE_ID_RN50_5969		0x5969</a>
<a name="ln31"> </a>
<a name="ln32">// M6</a>
<a name="ln33">#define DEVICE_ID_RADEON_LY		0x4c59</a>
<a name="ln34">#define DEVICE_ID_RADEON_LZ		0x4c5a</a>
<a name="ln35"> </a>
<a name="ln36">// RV200</a>
<a name="ln37">#define DEVICE_ID_RADEON_QW		0x5157</a>
<a name="ln38">#define DEVICE_ID_RADEON_QX		0x5158</a>
<a name="ln39"> </a>
<a name="ln40">// R200 mobility</a>
<a name="ln41">#define DEVICE_ID_RADEON_LW		0x4c57</a>
<a name="ln42">#define DEVICE_ID_RADEON_LX		0x4c58</a>
<a name="ln43"> </a>
<a name="ln44">// R200</a>
<a name="ln45">#define DEVICE_ID_RADEON_QH		0x5148</a>
<a name="ln46">#define DEVICE_ID_RADEON_QI		0x5149</a>
<a name="ln47">#define DEVICE_ID_RADEON_QJ		0x514a</a>
<a name="ln48">#define DEVICE_ID_RADEON_QK		0x514b</a>
<a name="ln49">#define DEVICE_ID_RADEON_QL		0x514c</a>
<a name="ln50">#define DEVICE_ID_RADEON_QM		0x514d</a>
<a name="ln51"> </a>
<a name="ln52">#define DEVICE_ID_RADEON_Qh		0x5168</a>
<a name="ln53">#define DEVICE_ID_RADEON_Qi		0x5169</a>
<a name="ln54">#define DEVICE_ID_RADEON_Qj		0x516a</a>
<a name="ln55">#define DEVICE_ID_RADEON_Qk		0x516b</a>
<a name="ln56"> </a>
<a name="ln57">#define DEVICE_ID_RADEON_BB		0x4242</a>
<a name="ln58">#define DEVICE_ID_RADEON_BC		0x4243</a>
<a name="ln59"> </a>
<a name="ln60">// RV250</a>
<a name="ln61">#define DEVICE_ID_RADEON_If     0x4966</a>
<a name="ln62">#define DEVICE_ID_RADEON_Ig     0x4967</a>
<a name="ln63"> </a>
<a name="ln64">// M9 (RV250)</a>
<a name="ln65">#define DEVICE_ID_RADEON_Ld     0x4c64</a>
<a name="ln66">#define DEVICE_ID_RADEON_Le     0x4c65</a>
<a name="ln67">#define DEVICE_ID_RADEON_Lf     0x4c66</a>
<a name="ln68">#define DEVICE_ID_RADEON_Lg     0x4c67</a>
<a name="ln69"> </a>
<a name="ln70">// RV280</a>
<a name="ln71">#define DEVICE_ID_RADEON_5960	0x5960</a>
<a name="ln72">#define DEVICE_ID_RADEON_Za		0x5961</a>
<a name="ln73">#define DEVICE_ID_RADEON_Zb		0x5962 // new</a>
<a name="ln74">#define DEVICE_ID_RADEON_Zd		0x5964</a>
<a name="ln75">#define DEVICE_ID_RADEON_Ze		0x5965 // new</a>
<a name="ln76"> </a>
<a name="ln77">// M9+ (RV280)</a>
<a name="ln78">#define DEVICE_ID_RADEON_5c61   0x5c61</a>
<a name="ln79">#define DEVICE_ID_RADEON_5c63   0x5c63 // new</a>
<a name="ln80"> </a>
<a name="ln81">// r300</a>
<a name="ln82">#define DEVICE_ID_RADEON_ND     0x4e44</a>
<a name="ln83">#define DEVICE_ID_RADEON_NE     0x4e45</a>
<a name="ln84">#define DEVICE_ID_RADEON_NF     0x4e46</a>
<a name="ln85">#define DEVICE_ID_RADEON_NG     0x4e47</a>
<a name="ln86"> </a>
<a name="ln87">// r300-4P</a>
<a name="ln88">#define DEVICE_ID_RADEON_AD     0x4144</a>
<a name="ln89">#define DEVICE_ID_RADEON_AE     0x4145</a>
<a name="ln90">#define DEVICE_ID_RADEON_AF     0x4146</a>
<a name="ln91">#define DEVICE_ID_RADEON_AG     0x4147</a>
<a name="ln92"> </a>
<a name="ln93">// rv350</a>
<a name="ln94">#define DEVICE_ID_RADEON_AP		0x4150</a>
<a name="ln95">#define DEVICE_ID_RADEON_AQ		0x4151</a>
<a name="ln96">#define DEVICE_ID_RADEON_AR		0x4152 // RS360</a>
<a name="ln97">#define DEVICE_ID_RADEON_AS		0x4153 // RV350 ?? on X.org</a>
<a name="ln98">#define DEVICE_ID_RADEON_AT		0x4154 // new</a>
<a name="ln99">#define DEVICE_ID_RADEON_4155	0x4155 // new</a>
<a name="ln100">#define DEVICE_ID_RADEON_AV		0x4156 // new</a>
<a name="ln101"> </a>
<a name="ln102">// m10 (rv350)</a>
<a name="ln103">#define DEVICE_ID_RADEON_NP		0x4e50</a>
<a name="ln104">#define DEVICE_ID_RADEON_NQ		0x4e51 // new</a>
<a name="ln105">#define DEVICE_ID_RADEON_NR		0x4e52 // new</a>
<a name="ln106">#define DEVICE_ID_RADEON_NS		0x4e53 // new</a>
<a name="ln107">#define DEVICE_ID_RADEON_NT		0x4e54</a>
<a name="ln108">#define DEVICE_ID_RADEON_NV		0x4e56 // new</a>
<a name="ln109"> </a>
<a name="ln110">// r350</a>
<a name="ln111">#define DEVICE_ID_RADEON_AH		0x4148</a>
<a name="ln112">#define DEVICE_ID_RADEON_AI		0x4149 // new</a>
<a name="ln113">#define DEVICE_ID_RADEON_AJ		0x414a // new</a>
<a name="ln114">#define DEVICE_ID_RADEON_AK		0x414b // new</a>
<a name="ln115">#define DEVICE_ID_RADEON_NH		0x4e48</a>
<a name="ln116">#define DEVICE_ID_RADEON_NI		0x4e49</a>
<a name="ln117">#define DEVICE_ID_RADEON_NK		0x4e4b // new</a>
<a name="ln118"> </a>
<a name="ln119">// r360</a>
<a name="ln120">#define DEVICE_ID_RADEON_NJ		0x4e4a</a>
<a name="ln121"> </a>
<a name="ln122">// rv370 X300</a>
<a name="ln123">//#define DEVICE_ID_RADEON_5b50	0x5b50</a>
<a name="ln124">#define DEVICE_ID_RADEON_5b60	0x5b60</a>
<a name="ln125">#define DEVICE_ID_RADEON_5b62	0x5b62</a>
<a name="ln126">#define DEVICE_ID_RADEON_5b63   0x5b63 // new</a>
<a name="ln127">#define DEVICE_ID_RADEON_5b64	0x5b64 // new</a>
<a name="ln128">#define DEVICE_ID_RADEON_5b65	0x5b65 // new</a>
<a name="ln129">#define DEVICE_ID_RADEON_5460	0x5460</a>
<a name="ln130">#define DEVICE_ID_RADEON_5464	0x5464 // new</a>
<a name="ln131"> </a>
<a name="ln132">// rv380 X600</a>
<a name="ln133">#define DEVICE_ID_RADEON_3e50	0x3e50</a>
<a name="ln134">#define DEVICE_ID_RADEON_3e54	0x3e54 // new</a>
<a name="ln135">#define DEVICE_ID_RADEON_3150	0x3150 // new</a>
<a name="ln136">#define DEVICE_ID_RADEON_3154	0x3154 // new</a>
<a name="ln137">#define DEVICE_ID_RADEON_5462	0x5462 // new X600SE on Toshiba M50 an X300???</a>
<a name="ln138"> </a>
<a name="ln139">// rv380 X600AIW</a>
<a name="ln140">#define DEVICE_ID_RADEON_5b62	0x5b62</a>
<a name="ln141"> </a>
<a name="ln142">// rv410 X700 pro</a>
<a name="ln143">#define DEVICE_ID_RADEON_5e48	0x5e48 // new</a>
<a name="ln144">#define DEVICE_ID_RADEON_564a	0x564a // new</a>
<a name="ln145">#define DEVICE_ID_RADEON_564b	0x564b // new</a>
<a name="ln146">#define DEVICE_ID_RADEON_564f	0x564f // new</a>
<a name="ln147">#define DEVICE_ID_RADEON_5652	0x5652 // new</a>
<a name="ln148">#define DEVICE_ID_RADEON_5653	0x5653 // new</a>
<a name="ln149">#define DEVICE_ID_RADEON_5e4b	0x5e4b</a>
<a name="ln150">#define DEVICE_ID_RADEON_5e4a	0x5e4a // new</a>
<a name="ln151">#define DEVICE_ID_RADEON_5e4d	0x5e4d // new</a>
<a name="ln152">#define DEVICE_ID_RADEON_5e4c	0x5e4c // new</a>
<a name="ln153">#define DEVICE_ID_RADEON_5e4f	0x5e4f // new</a>
<a name="ln154"> </a>
<a name="ln155"> </a>
<a name="ln156">// r420 X800</a>
<a name="ln157">#define DEVICE_ID_RADEON_JH 	0x4a48 // new</a>
<a name="ln158">#define DEVICE_ID_RADEON_JI		0x4a49</a>
<a name="ln159">#define DEVICE_ID_RADEON_JJ 	0x4a4a</a>
<a name="ln160">#define DEVICE_ID_RADEON_JK		0x4a4b</a>
<a name="ln161">#define DEVICE_ID_RADEON_JL		0x4a4c // new mobility</a>
<a name="ln162">#define DEVICE_ID_RADEON_JM 	0x4a4d // new</a>
<a name="ln163">#define DEVICE_ID_RADEON_JN		0x4a4e // new</a>
<a name="ln164">#define DEVICE_ID_RADEON_JP		0x4a50</a>
<a name="ln165">#define DEVICE_ID_RADEON_4a4f	0x4a4f // new</a>
<a name="ln166"> </a>
<a name="ln167">// r423 X800</a>
<a name="ln168">#define DEVICE_ID_RADEON_UH		0x5548 // new</a>
<a name="ln169">#define DEVICE_ID_RADEON_UI		0x5549</a>
<a name="ln170">#define DEVICE_ID_RADEON_UJ		0x554a</a>
<a name="ln171">#define DEVICE_ID_RADEON_UK		0x554b</a>
<a name="ln172">#define DEVICE_ID_RADEON_UQ		0x5551 // new</a>
<a name="ln173">#define DEVICE_ID_RADEON_UR		0x5552 // new</a>
<a name="ln174">#define DEVICE_ID_RADEON_UT		0x5554 // new</a>
<a name="ln175"> </a>
<a name="ln176">#define DEVICE_ID_RADEON_UM		0x554d // ?</a>
<a name="ln177">#define DEVICE_ID_RADEON_UO		0x554f // ?</a>
<a name="ln178"> </a>
<a name="ln179">#define DEVICE_ID_RADEON_5d57	0x5d57</a>
<a name="ln180">#define DEVICE_ID_RADEON_5550	0x5550 // new</a>
<a name="ln181"> </a>
<a name="ln182">// r430 X850</a>
<a name="ln183">#define DEVICE_ID_RADEON_5d49	0x5d49 // new mob</a>
<a name="ln184">#define DEVICE_ID_RADEON_5d4a	0x5d4a // new mob</a>
<a name="ln185">#define DEVICE_ID_RADEON_5d48	0x5d48 // new mob</a>
<a name="ln186">#define DEVICE_ID_RADEON_554f	0x554f // new</a>
<a name="ln187">#define DEVICE_ID_RADEON_554d	0x554d // new</a>
<a name="ln188">#define DEVICE_ID_RADEON_554e	0x554e // new</a>
<a name="ln189">#define DEVICE_ID_RADEON_554c	0x554c // new</a>
<a name="ln190"> </a>
<a name="ln191">// r480</a>
<a name="ln192">#define DEVICE_ID_RADEON_5d4c	0x5d4c // new</a>
<a name="ln193">#define DEVICE_ID_RADEON_5d50	0x5d50 // new</a>
<a name="ln194">#define DEVICE_ID_RADEON_5d4e	0x5d4e // new</a>
<a name="ln195">#define DEVICE_ID_RADEON_5d4f	0x5d4f // new</a>
<a name="ln196">#define DEVICE_ID_RADEON_5d52	0x5d52 // new</a>
<a name="ln197">#define DEVICE_ID_RADEON_5d4d	0x5d4d // new</a>
<a name="ln198"> </a>
<a name="ln199">// r481</a>
<a name="ln200">#define DEVICE_ID_RADEON_KJ		0x4b4a</a>
<a name="ln201">#define DEVICE_ID_RADEON_KK		0x4b4b</a>
<a name="ln202">#define DEVICE_ID_RADEON_KL		0x4b4c</a>
<a name="ln203">#define DEVICE_ID_RADEON_KI		0x4b49</a>
<a name="ln204"> </a>
<a name="ln205">// rs100</a>
<a name="ln206">#define DEVICE_ID_RS100_4136	0x4136</a>
<a name="ln207">#define DEVICE_ID_RS100_4336	0x4336</a>
<a name="ln208"> </a>
<a name="ln209">// rs200</a>
<a name="ln210">#define DEVICE_ID_RS200_4337	0x4337</a>
<a name="ln211">#define DEVICE_ID_RS200_4137	0x4137</a>
<a name="ln212"> </a>
<a name="ln213">// rs250</a>
<a name="ln214">#define DEVICE_ID_RS250_4237	0x4237</a>
<a name="ln215">#define DEVICE_ID_RS250_4437	0x4437</a>
<a name="ln216"> </a>
<a name="ln217">// rs300</a>
<a name="ln218">#define DEVICE_ID_RS300_5834	0x5834</a>
<a name="ln219">#define DEVICE_ID_RS300_5835	0x5835</a>
<a name="ln220"> </a>
<a name="ln221">// rs350</a>
<a name="ln222">#define DEVICE_ID_RS350_7834	0x7834</a>
<a name="ln223">#define DEVICE_ID_RS350_7835	0x7835</a>
<a name="ln224"> </a>
<a name="ln225">// rs400</a>
<a name="ln226">#define DEVICE_ID_RS400_5a41	0x5a41</a>
<a name="ln227">#define DEVICE_ID_RS400_5a42	0x5a42</a>
<a name="ln228"> </a>
<a name="ln229">// rs410</a>
<a name="ln230">#define DEVICE_ID_RS410_5a61	0x5a61</a>
<a name="ln231">#define DEVICE_ID_RS410_5a62	0x5a62</a>
<a name="ln232"> </a>
<a name="ln233">// rs480/82</a>
<a name="ln234">#define DEVICE_ID_RS480_5954	0x5954</a>
<a name="ln235">#define DEVICE_ID_RS480_5955	0x5955</a>
<a name="ln236">#define DEVICE_ID_RS482_5974	0x5974</a>
<a name="ln237">#define DEVICE_ID_RS482_5975	0x5975</a>
<a name="ln238"> </a>
<a name="ln239">typedef struct {</a>
<a name="ln240">	uint16 device_id;</a>
<a name="ln241">	radeon_type asic;</a>
<a name="ln242">	uint32 features;</a>
<a name="ln243">	char *name;</a>
<a name="ln244">} RadeonDevice;</a>
<a name="ln245"> </a>
<a name="ln246">#define STD_RADEON 0 // common as muck PC graphics card (if there is such a thing)</a>
<a name="ln247">#define ISMOBILITY 1 // is mobility</a>
<a name="ln248">#define INTEGRATED 2 // is IGP (Integrated Graphics Processor) onboard video</a>
<a name="ln249">#define MOBILE_IGP ISMOBILITY | INTEGRATED // 2 disabilites for the price of 1</a>
<a name="ln250"> </a>
<a name="ln251">// list of supported devices</a>
<a name="ln252">RadeonDevice radeon_device_list[] = {</a>
<a name="ln253">	// original Radeons, now called r100</a>
<a name="ln254">	{ DEVICE_ID_RADEON_QD, rt_r100, STD_RADEON, &quot;Radeon 7200 / Radeon / ALL-IN-WONDER Radeon&quot; },</a>
<a name="ln255">	{ DEVICE_ID_RADEON_QE, rt_r100, STD_RADEON, &quot;Radeon QE&quot; },</a>
<a name="ln256">	{ DEVICE_ID_RADEON_QF, rt_r100, STD_RADEON, &quot;Radeon QF&quot; },</a>
<a name="ln257">	{ DEVICE_ID_RADEON_QG, rt_r100, STD_RADEON, &quot;Radeon QG&quot; },</a>
<a name="ln258"> </a>
<a name="ln259">	// Radeon VE (low-cost, dual CRT, no TCL), was rt_ve now refered to as rv100</a>
<a name="ln260">	{ DEVICE_ID_RADEON_QY, rt_rv100, STD_RADEON, &quot;Radeon 7000 / Radeon VE&quot; },</a>
<a name="ln261">	{ DEVICE_ID_RADEON_QZ, rt_rv100, STD_RADEON, &quot;Radeon QZ VE&quot; },</a>
<a name="ln262"> </a>
<a name="ln263">	{ DEVICE_ID_RN50_515E, rt_rv100, STD_RADEON, &quot;ES1000 515E (PCI)&quot; }, // Evans and Sutherland something or other?</a>
<a name="ln264">	{ DEVICE_ID_RN50_5969, rt_rv100, STD_RADEON, &quot;ES1000 5969 (PCI)&quot; },</a>
<a name="ln265"> </a>
<a name="ln266">	// mobility version of original Radeon (based on VE), now called M6</a>
<a name="ln267">	{ DEVICE_ID_RADEON_LY, rt_rv100, ISMOBILITY, &quot;Radeon Mobility&quot; },</a>
<a name="ln268">	{ DEVICE_ID_RADEON_LZ, rt_rv100, ISMOBILITY, &quot;Radeon Mobility M6 LZ&quot; },</a>
<a name="ln269"> </a>
<a name="ln270">	// RV200 (dual CRT)</a>
<a name="ln271">	{ DEVICE_ID_RADEON_QW, rt_rv200, STD_RADEON, &quot;Radeon 7500 / ALL-IN-WONDER Radeon 7500&quot; },</a>
<a name="ln272">	{ DEVICE_ID_RADEON_QX, rt_rv200, STD_RADEON, &quot;Radeon 7500 QX&quot; },</a>
<a name="ln273"> </a>
<a name="ln274">	// M7 (based on RV200) was rt_m 7</a>
<a name="ln275">	{ DEVICE_ID_RADEON_LW, rt_rv200, ISMOBILITY, &quot;Radeon Mobility 7500&quot; },</a>
<a name="ln276">	{ DEVICE_ID_RADEON_LX, rt_rv200, ISMOBILITY, &quot;Radeon Mobility 7500 GL&quot; },</a>
<a name="ln277"> </a>
<a name="ln278">	// R200</a>
<a name="ln279">	{ DEVICE_ID_RADEON_QH, rt_r200, STD_RADEON, &quot;Fire GL E1&quot; },	// chip fgl8800</a>
<a name="ln280">	{ DEVICE_ID_RADEON_QI, rt_r200, STD_RADEON, &quot;Radeon 8500 QI&quot; },</a>
<a name="ln281">	{ DEVICE_ID_RADEON_QJ, rt_r200, STD_RADEON, &quot;Radeon 8500 QJ&quot; },</a>
<a name="ln282">	{ DEVICE_ID_RADEON_QK, rt_r200, STD_RADEON, &quot;Radeon 8500 QK&quot; },</a>
<a name="ln283">	{ DEVICE_ID_RADEON_QL, rt_r200, STD_RADEON, &quot;Radeon 8500 / 8500LE / ALL-IN-WONDER Radeon 8500&quot; },</a>
<a name="ln284">	{ DEVICE_ID_RADEON_QM, rt_r200, STD_RADEON, &quot;Radeon 9100&quot; },</a>
<a name="ln285"> </a>
<a name="ln286">	{ DEVICE_ID_RADEON_Qh, rt_r200, STD_RADEON, &quot;Radeon 8500 Qh&quot; },</a>
<a name="ln287">	{ DEVICE_ID_RADEON_Qi, rt_r200, STD_RADEON, &quot;Radeon 8500 Qi&quot; },</a>
<a name="ln288">	{ DEVICE_ID_RADEON_Qj, rt_r200, STD_RADEON, &quot;Radeon 8500 Qj&quot; },</a>
<a name="ln289">	{ DEVICE_ID_RADEON_Qk, rt_r200, STD_RADEON, &quot;Radeon 8500 Qk&quot; },</a>
<a name="ln290"> </a>
<a name="ln291">	{ DEVICE_ID_RADEON_BB, rt_r200, STD_RADEON, &quot;ALL-IN-Wonder Radeon 8500 DV (BB)&quot; },</a>
<a name="ln292">	{ DEVICE_ID_RADEON_BC, rt_r200, STD_RADEON, &quot;ALL-IN-Wonder Radeon 8500 DV (BC)&quot; },</a>
<a name="ln293"> </a>
<a name="ln294">	// RV250 (cut-down R200 with integrated TV-Out)</a>
<a name="ln295">	{ DEVICE_ID_RADEON_If, rt_rv250, STD_RADEON, &quot;Radeon 9000&quot; },</a>
<a name="ln296">	{ DEVICE_ID_RADEON_Ig, rt_rv250, STD_RADEON, &quot;Radeon 9000 Ig&quot; },</a>
<a name="ln297"> </a>
<a name="ln298">	// M9 (based on rv250) was rt_m9</a>
<a name="ln299">	{ DEVICE_ID_RADEON_Ld, rt_rv250, ISMOBILITY, &quot;Radeon Mobility 9000 Ld&quot; },</a>
<a name="ln300">	{ DEVICE_ID_RADEON_Le, rt_rv250, ISMOBILITY, &quot;Radeon Mobility 9000 Le&quot; },</a>
<a name="ln301">	{ DEVICE_ID_RADEON_Lf, rt_rv250, ISMOBILITY, &quot;Radeon Mobility 9000 Lf&quot; },</a>
<a name="ln302">	{ DEVICE_ID_RADEON_Lg, rt_rv250, ISMOBILITY, &quot;Radeon Mobility 9000 Lg&quot; },</a>
<a name="ln303"> </a>
<a name="ln304">	// RV280 (rv250 but faster)</a>
<a name="ln305">	{ DEVICE_ID_RADEON_5960, rt_rv280, STD_RADEON, &quot;Radeon 9200 Pro&quot; },</a>
<a name="ln306">	{ DEVICE_ID_RADEON_Za, rt_rv280, STD_RADEON, &quot;Radeon 9200&quot; },</a>
<a name="ln307">	{ DEVICE_ID_RADEON_Zb, rt_rv280, STD_RADEON, &quot;Radeon 9200&quot; },</a>
<a name="ln308">	{ DEVICE_ID_RADEON_Zd, rt_rv280, STD_RADEON, &quot;Radeon 9200 SE&quot; },</a>
<a name="ln309">	{ DEVICE_ID_RADEON_Ze, rt_rv280, STD_RADEON, &quot;Ati FireMV 2200&quot; },</a>
<a name="ln310"> </a>
<a name="ln311">	// M9+ (based on rv280) was rt_m9plus</a>
<a name="ln312">	{ DEVICE_ID_RADEON_5c61, rt_rv280, ISMOBILITY, &quot;Radeon Mobility 9200&quot; },</a>
<a name="ln313">	{ DEVICE_ID_RADEON_5c63, rt_rv280, ISMOBILITY, &quot;Radeon Mobility 9200&quot; },</a>
<a name="ln314"> </a>
<a name="ln315">	// R300</a>
<a name="ln316">	{ DEVICE_ID_RADEON_ND, rt_r300, STD_RADEON, &quot;Radeon 9700 ND&quot; },</a>
<a name="ln317">	{ DEVICE_ID_RADEON_NE, rt_r300, STD_RADEON, &quot;Radeon 9700 NE&quot; },</a>
<a name="ln318">	{ DEVICE_ID_RADEON_NF, rt_r300, STD_RADEON, &quot;Radeon 9600 XT&quot; },</a>
<a name="ln319">	{ DEVICE_ID_RADEON_NG, rt_r300, STD_RADEON, &quot;Radeon 9700 NG&quot; },</a>
<a name="ln320"> </a>
<a name="ln321">	// r300-4P</a>
<a name="ln322">	{ DEVICE_ID_RADEON_AD, rt_r300, STD_RADEON, &quot;Radeon 9700 AD&quot; },</a>
<a name="ln323">	{ DEVICE_ID_RADEON_AE, rt_r300, STD_RADEON, &quot;Radeon 9700 AE&quot; },</a>
<a name="ln324">	{ DEVICE_ID_RADEON_AF, rt_r300, STD_RADEON, &quot;Radeon 9700 AF&quot; },</a>
<a name="ln325">	{ DEVICE_ID_RADEON_AG, rt_r300, STD_RADEON, &quot;Radeon 9700 AG&quot; },</a>
<a name="ln326"> </a>
<a name="ln327">	// RV350</a>
<a name="ln328">	{ DEVICE_ID_RADEON_AP, rt_rv350, STD_RADEON, &quot;Radeon 9600 AP&quot; },</a>
<a name="ln329">	{ DEVICE_ID_RADEON_AQ, rt_rv350, STD_RADEON, &quot;Radeon 9600SE AQ&quot; },</a>
<a name="ln330">	{ DEVICE_ID_RADEON_AR, rt_rv350, STD_RADEON, &quot;Radeon 9600XT AR&quot; },</a>
<a name="ln331">	{ DEVICE_ID_RADEON_AS, rt_rv350, STD_RADEON, &quot;Radeon 9550 AS&quot; },</a>
<a name="ln332">	{ DEVICE_ID_RADEON_AT, rt_rv350, STD_RADEON, &quot;FireGL T2 AT&quot; },</a>
<a name="ln333">	{ DEVICE_ID_RADEON_4155, rt_rv350, STD_RADEON, &quot;Radeon 9650 4155&quot; },</a>
<a name="ln334">	{ DEVICE_ID_RADEON_AV, rt_rv350, STD_RADEON, &quot;Radeon 9600 AQ&quot; },</a>
<a name="ln335"> </a>
<a name="ln336">	// rv350 M10 (based on rv350) was rt_m10</a>
<a name="ln337">	{ DEVICE_ID_RADEON_NP, rt_rv350, ISMOBILITY, &quot;Radeon Mobility 9600/9700 (M10/M11) NP &quot; },</a>
<a name="ln338">	{ DEVICE_ID_RADEON_NQ, rt_rv350, ISMOBILITY, &quot;Radeon Mobility 9600 (M10) NQ &quot; },</a>
<a name="ln339">	{ DEVICE_ID_RADEON_NR, rt_rv350, ISMOBILITY, &quot;Radeon Mobility 9600 (M11) NR &quot; },</a>
<a name="ln340">	{ DEVICE_ID_RADEON_NS, rt_rv350, ISMOBILITY, &quot;Radeon Mobility 9600 (M10) NS &quot; },</a>
<a name="ln341">	{ DEVICE_ID_RADEON_NT, rt_rv350, ISMOBILITY, &quot;ATI FireGL Mobility T2 (M10) NT&quot; },</a>
<a name="ln342">	{ DEVICE_ID_RADEON_NV, rt_rv350, ISMOBILITY, &quot;ATI FireGL Mobility T2e (M11) NV&quot; },</a>
<a name="ln343"> </a>
<a name="ln344">	// R350</a>
<a name="ln345">	{ DEVICE_ID_RADEON_AH, rt_r350, STD_RADEON, &quot;Radeon 9800SE AH&quot; },</a>
<a name="ln346">	{ DEVICE_ID_RADEON_AI, rt_r350, STD_RADEON, &quot;Radeon 9800 AI&quot; },</a>
<a name="ln347">	{ DEVICE_ID_RADEON_AJ, rt_r350, STD_RADEON, &quot;Radeon 9800 AJ&quot; },</a>
<a name="ln348">	{ DEVICE_ID_RADEON_AK, rt_r350, STD_RADEON, &quot;FireGL X2 AK&quot; },</a>
<a name="ln349">	{ DEVICE_ID_RADEON_NH, rt_r350, STD_RADEON, &quot;Radeon 9800 Pro NH&quot; },</a>
<a name="ln350">	{ DEVICE_ID_RADEON_NI, rt_r350, STD_RADEON, &quot;Radeon 9800 NI&quot; },</a>
<a name="ln351">	{ DEVICE_ID_RADEON_NK, rt_r350, STD_RADEON, &quot;FireGL X2 NK&quot; },</a>
<a name="ln352">	{ DEVICE_ID_RADEON_NJ, rt_r350, STD_RADEON, &quot;Radeon 9800 XT&quot; },</a>
<a name="ln353"> </a>
<a name="ln354">	// rv370</a>
<a name="ln355">	{ DEVICE_ID_RADEON_5b60, rt_rv380, STD_RADEON, &quot;Radeon X300 (RV370) 5B60&quot; },</a>
<a name="ln356">	{ DEVICE_ID_RADEON_5b62, rt_rv380, STD_RADEON, &quot;Radeon X600 (RV370) 5B62&quot; },</a>
<a name="ln357">	{ DEVICE_ID_RADEON_5b63, rt_rv380, STD_RADEON, &quot;Radeon X1050 (RV370) 5B63&quot; },</a>
<a name="ln358">	{ DEVICE_ID_RADEON_5b64, rt_rv380, STD_RADEON, &quot;FireGL V3100 (RV370) 5B64&quot; },</a>
<a name="ln359">	{ DEVICE_ID_RADEON_5b65, rt_rv380, STD_RADEON, &quot;FireGL D1100 (RV370) 5B65&quot; },</a>
<a name="ln360">	{ DEVICE_ID_RADEON_5460, rt_rv380, ISMOBILITY, &quot;Radeon Mobility M300 (M22) 5460&quot; },</a>
<a name="ln361">	{ DEVICE_ID_RADEON_5464, rt_rv380, ISMOBILITY, &quot;FireGL M22 GL 5464&quot; },</a>
<a name="ln362"> </a>
<a name="ln363">	// rv380</a>
<a name="ln364">	{ DEVICE_ID_RADEON_3e50, rt_rv380, STD_RADEON, &quot;Radeon X600 (RV380) 3E50&quot; },</a>
<a name="ln365">	{ DEVICE_ID_RADEON_3e54, rt_rv380, STD_RADEON, &quot;FireGL V3200 (RV380) 3E54&quot; },</a>
<a name="ln366">	{ DEVICE_ID_RADEON_3150, rt_rv380, ISMOBILITY, &quot;Radeon Mobility X600 (M24) 3150&quot; },</a>
<a name="ln367">	{ DEVICE_ID_RADEON_3154, rt_rv380, ISMOBILITY, &quot;FireGL M24 GL 3154&quot; },</a>
<a name="ln368">	{ DEVICE_ID_RADEON_5462, rt_rv380, ISMOBILITY, &quot;Radeon X600SE (RV3?0) 5462&quot; },</a>
<a name="ln369"> </a>
<a name="ln370">	// rv380</a>
<a name="ln371">	{ DEVICE_ID_RADEON_5b62, rt_rv380, STD_RADEON, &quot;Radeon X600 AIW&quot; },</a>
<a name="ln372"> </a>
<a name="ln373">	// rv410</a>
<a name="ln374">	{ DEVICE_ID_RADEON_5e48, rt_r420, STD_RADEON, &quot;FireGL V5000 (RV410)&quot; },</a>
<a name="ln375">	{ DEVICE_ID_RADEON_564a, rt_r420, ISMOBILITY, &quot;Mobility FireGL V5000 (M26)&quot; },</a>
<a name="ln376">	{ DEVICE_ID_RADEON_564b, rt_r420, ISMOBILITY, &quot;Mobility FireGL V5000 (M26)&quot; },</a>
<a name="ln377">	{ DEVICE_ID_RADEON_564f, rt_r420, ISMOBILITY, &quot;Mobility Radeon X700 XL (M26)&quot; },</a>
<a name="ln378">	{ DEVICE_ID_RADEON_5652, rt_r420, ISMOBILITY, &quot;Mobility Radeon X700 (M26)&quot; },</a>
<a name="ln379">	{ DEVICE_ID_RADEON_5653, rt_r420, ISMOBILITY, &quot;Mobility Radeon X700 (M26)&quot; },</a>
<a name="ln380">	{ DEVICE_ID_RADEON_5e4b, rt_r420, STD_RADEON, &quot;Radeon X700 PRO (RV410)&quot; },</a>
<a name="ln381">	{ DEVICE_ID_RADEON_5e4a, rt_r420, STD_RADEON, &quot;Radeon X700 XT (RV410)&quot; },</a>
<a name="ln382">	{ DEVICE_ID_RADEON_5e4d, rt_r420, STD_RADEON, &quot;Radeon X700 (RV410)&quot; },</a>
<a name="ln383">	{ DEVICE_ID_RADEON_5e4c, rt_r420, STD_RADEON, &quot;Radeon X700 SE (RV410)&quot; },</a>
<a name="ln384">	{ DEVICE_ID_RADEON_5e4f, rt_r420, STD_RADEON, &quot;Radeon X700 SE (RV410)&quot; },</a>
<a name="ln385"> </a>
<a name="ln386">	// r420</a>
<a name="ln387">	{ DEVICE_ID_RADEON_JH, rt_r420, STD_RADEON, &quot;Radeon X800 (R420) JH&quot; },</a>
<a name="ln388">	{ DEVICE_ID_RADEON_JI, rt_r420, STD_RADEON, &quot;Radeon X800PRO (R420) JI&quot; },</a>
<a name="ln389">	{ DEVICE_ID_RADEON_JJ, rt_r420, STD_RADEON, &quot;Radeon X800SE (R420) JJ&quot; },</a>
<a name="ln390">	{ DEVICE_ID_RADEON_JK, rt_r420, STD_RADEON, &quot;Radeon X800 (R420) JK&quot; },</a>
<a name="ln391">	{ DEVICE_ID_RADEON_JL, rt_r420, STD_RADEON, &quot;Radeon X800 (R420) JL&quot; },</a>
<a name="ln392">	{ DEVICE_ID_RADEON_JM, rt_r420, STD_RADEON, &quot;FireGL X3 (R420) JM&quot; },</a>
<a name="ln393">	{ DEVICE_ID_RADEON_JN, rt_r420, ISMOBILITY, &quot;Radeon Mobility 9800 (M18) JN&quot; },</a>
<a name="ln394">	{ DEVICE_ID_RADEON_JP, rt_r420, STD_RADEON, &quot;Radeon X800XT (R420) JP&quot; },</a>
<a name="ln395">	{ DEVICE_ID_RADEON_4a4f, rt_r420, STD_RADEON, &quot;Radeon X800 SE (R420)&quot; },</a>
<a name="ln396"> </a>
<a name="ln397">	// r423</a>
<a name="ln398">	{ DEVICE_ID_RADEON_UH, rt_r420, STD_RADEON, &quot;Radeon X800 (R423) UH&quot; },</a>
<a name="ln399">	{ DEVICE_ID_RADEON_UI, rt_r420, STD_RADEON, &quot;Radeon X800PRO (R423) UI&quot; },</a>
<a name="ln400">	{ DEVICE_ID_RADEON_UJ, rt_r420, STD_RADEON, &quot;Radeon X800LE (R423) UJ&quot; },</a>
<a name="ln401">	{ DEVICE_ID_RADEON_UK, rt_r420, STD_RADEON, &quot;Radeon X800SE (R423) UK&quot; },</a>
<a name="ln402">	{ DEVICE_ID_RADEON_UQ, rt_r420, STD_RADEON, &quot;FireGL V7200 (R423) UQ&quot; },</a>
<a name="ln403">	{ DEVICE_ID_RADEON_UR, rt_r420, STD_RADEON, &quot;FireGL V5100 (R423) UR&quot; },</a>
<a name="ln404">	{ DEVICE_ID_RADEON_UT, rt_r420, STD_RADEON, &quot;FireGL V7100 (R423) UT&quot; },</a>
<a name="ln405"> </a>
<a name="ln406">	{ DEVICE_ID_RADEON_UO, rt_r420, STD_RADEON, &quot;Radeon X800 UO&quot; },</a>
<a name="ln407">	{ DEVICE_ID_RADEON_UM, rt_r420, STD_RADEON, &quot;Radeon X800 UM&quot; },</a>
<a name="ln408"> </a>
<a name="ln409">	{ DEVICE_ID_RADEON_5d57, rt_r420, STD_RADEON, &quot;Radeon X800 XT&quot; },</a>
<a name="ln410">	{ DEVICE_ID_RADEON_5550, rt_r420, STD_RADEON, &quot;FireGL V7100 (R423)&quot; },</a>
<a name="ln411"> </a>
<a name="ln412">	// r430</a>
<a name="ln413">	{ DEVICE_ID_RADEON_5d49, rt_r420, ISMOBILITY, &quot;Mobility FireGL V5100 (M28)&quot; },</a>
<a name="ln414">	{ DEVICE_ID_RADEON_5d4a, rt_r420, ISMOBILITY, &quot;Mobility Radeon X800 (M28)&quot; },</a>
<a name="ln415">	{ DEVICE_ID_RADEON_5d48, rt_r420, ISMOBILITY, &quot;Mobility Radeon X800 XT (M28)&quot; },</a>
<a name="ln416">	{ DEVICE_ID_RADEON_554f, rt_r420, STD_RADEON, &quot;Radeon X800 (R430)&quot; },</a>
<a name="ln417">	{ DEVICE_ID_RADEON_554d, rt_r420, STD_RADEON, &quot;Radeon X800 XL (R430)&quot; },</a>
<a name="ln418">	{ DEVICE_ID_RADEON_554e, rt_r420, STD_RADEON, &quot;Radeon X800 SE (R430)&quot; },</a>
<a name="ln419">	{ DEVICE_ID_RADEON_554c, rt_r420, STD_RADEON, &quot;Radeon X800 XTP (R430)&quot; },</a>
<a name="ln420"> </a>
<a name="ln421">	// r480</a>
<a name="ln422">	{ DEVICE_ID_RADEON_5d4c, rt_r420, STD_RADEON, &quot;Radeon X850 5D4C&quot; },</a>
<a name="ln423">	{ DEVICE_ID_RADEON_5d50, rt_r420, STD_RADEON, &quot;Radeon FireGL (R480) GL 5D50&quot; },</a>
<a name="ln424">	{ DEVICE_ID_RADEON_5d4e, rt_r420, STD_RADEON, &quot;Radeon X850 SE (R480)&quot; },</a>
<a name="ln425">	{ DEVICE_ID_RADEON_5d4f, rt_r420, STD_RADEON, &quot;Radeon X850 PRO (R480)&quot; },</a>
<a name="ln426">	{ DEVICE_ID_RADEON_5d52, rt_r420, STD_RADEON, &quot;Radeon X850 XT (R480)&quot; },</a>
<a name="ln427">	{ DEVICE_ID_RADEON_5d4d, rt_r420, STD_RADEON, &quot;Radeon X850 XT PE (R480)&quot; },</a>
<a name="ln428"> </a>
<a name="ln429">	// r481</a>
<a name="ln430">	{ DEVICE_ID_RADEON_KJ, rt_r420, STD_RADEON, &quot;Radeon X850 PRO (R480)&quot; },</a>
<a name="ln431">	{ DEVICE_ID_RADEON_KK, rt_r420, STD_RADEON, &quot;Radeon X850 SE (R480)&quot; },</a>
<a name="ln432">	{ DEVICE_ID_RADEON_KL, rt_r420, STD_RADEON, &quot;Radeon X850 XT (R480)&quot; },</a>
<a name="ln433">	{ DEVICE_ID_RADEON_KI, rt_r420, STD_RADEON, &quot;Radeon X850 XT PE (R480)&quot; },</a>
<a name="ln434"> </a>
<a name="ln435">	// rs100 (aka IGP 320)</a>
<a name="ln436">	{ DEVICE_ID_RS100_4136, rt_rs100, INTEGRATED, &quot;Radeon IGP320 (A3) 4136&quot; },</a>
<a name="ln437">	{ DEVICE_ID_RS100_4336, rt_rs100, MOBILE_IGP, &quot;Radeon IGP320M (U1) 4336&quot; },</a>
<a name="ln438"> </a>
<a name="ln439">	// rs200 (aka IGP 340)</a>
<a name="ln440">	{ DEVICE_ID_RS200_4137, rt_rs200, INTEGRATED, &quot;Radeon IGP330/340/350 (A4) 4137&quot; },</a>
<a name="ln441">	{ DEVICE_ID_RS200_4337, rt_rs200, MOBILE_IGP, &quot;Radeon IGP330M/340M/350M (U2) 4337&quot; },</a>
<a name="ln442"> </a>
<a name="ln443">	// rs250 (aka 7000 IGP)</a>
<a name="ln444">	{ DEVICE_ID_RS250_4237, rt_rs200, INTEGRATED, &quot;IGP330M/340M/350M (U2) 4337&quot; },</a>
<a name="ln445">	{ DEVICE_ID_RS250_4437, rt_rs200, MOBILE_IGP, &quot;Radeon Mobility 7000 IGP 4437&quot; },</a>
<a name="ln446"> </a>
<a name="ln447">	// rs300</a>
<a name="ln448">	{ DEVICE_ID_RS300_5834, rt_rs300, INTEGRATED, &quot;Radeon 9100 IGP (A5) 5834&quot; },</a>
<a name="ln449">	{ DEVICE_ID_RS300_5835, rt_rs300, MOBILE_IGP, &quot;Radeon Mobility 9100 IGP (U3) 5835&quot; },</a>
<a name="ln450"> </a>
<a name="ln451">	// rs350</a>
<a name="ln452">	{ DEVICE_ID_RS350_7834, rt_rs300, INTEGRATED, &quot;Radeon 9100 PRO IGP 7834&quot; },</a>
<a name="ln453">	{ DEVICE_ID_RS350_7835, rt_rs300, MOBILE_IGP, &quot;Radeon Mobility 9200 IGP 7835&quot; },</a>
<a name="ln454"> </a>
<a name="ln455">	// rs400</a>
<a name="ln456">	{ DEVICE_ID_RS400_5a41, rt_rv380, STD_RADEON, &quot;Radeon XPRESS 200 5A41&quot; }, // X.org people unsure what this is for now</a>
<a name="ln457">	{ DEVICE_ID_RS400_5a42, rt_rv380, ISMOBILITY, &quot;Radeon XPRESS 200M 5A42&quot; },</a>
<a name="ln458"> </a>
<a name="ln459">	// rs410</a>
<a name="ln460">	{ DEVICE_ID_RS410_5a61, rt_rv380, STD_RADEON, &quot;Radeon XPRESS 200 5A61&quot; }, // X.org people unsure what this is for now</a>
<a name="ln461">	{ DEVICE_ID_RS410_5a62, rt_rv380, ISMOBILITY, &quot;Radeon XPRESS 200M 5A62&quot; },</a>
<a name="ln462"> </a>
<a name="ln463">	// rs480</a>
<a name="ln464">	{ DEVICE_ID_RS480_5954, rt_rv380, STD_RADEON, &quot;Radeon XPRESS 200 5954&quot; }, // X.org people unsure what this is for now</a>
<a name="ln465">	{ DEVICE_ID_RS480_5955, rt_rv380, ISMOBILITY, &quot;Radeon XPRESS 200M 5955&quot; },</a>
<a name="ln466">	{ DEVICE_ID_RS482_5974, rt_rv380, STD_RADEON, &quot;Radeon XPRESS 200 5974&quot; }, // X.org people unsure what this is for now</a>
<a name="ln467">	{ DEVICE_ID_RS482_5975, rt_rv380, ISMOBILITY, &quot;Radeon XPRESS 200M 5975&quot; },</a>
<a name="ln468"> </a>
<a name="ln469">	{ 0, 0, 0, NULL }</a>
<a name="ln470">};</a>
<a name="ln471"> </a>
<a name="ln472"> </a>
<a name="ln473">// list of supported vendors (there aren't many ;)</a>
<a name="ln474">static struct {</a>
<a name="ln475">	uint16	vendor_id;</a>
<a name="ln476">	RadeonDevice *devices;</a>
<a name="ln477">} SupportedVendors[] = {</a>
<a name="ln478">	{ VENDOR_ID_ATI, radeon_device_list },</a>
<a name="ln479">	{ 0x0000, NULL }</a>
<a name="ln480">};</a>
<a name="ln481"> </a>
<a name="ln482">// check, whether there is *any* supported card plugged in</a>
<a name="ln483">bool Radeon_CardDetect(void)</a>
<a name="ln484">{</a>
<a name="ln485">	long		pci_index = 0;</a>
<a name="ln486">	pci_info	pcii;</a>
<a name="ln487">	bool		found_one = FALSE;</a>
<a name="ln488"> </a>
<a name="ln489">	if (get_module(B_PCI_MODULE_NAME, (module_info **)&amp;pci_bus) != B_OK)</a>
<a name="ln490">		return B_ERROR;</a>
<a name="ln491"> </a>
<a name="ln492">	while ((*pci_bus-&gt;get_nth_pci_info)(pci_index, &amp;pcii) == B_NO_ERROR) {</a>
<a name="ln493">		int vendor = 0;</a>
<a name="ln494"> </a>
<a name="ln495">		while (SupportedVendors[vendor].vendor_id) {</a>
<a name="ln496">			if (SupportedVendors[vendor].vendor_id == pcii.vendor_id) {</a>
<a name="ln497">				RadeonDevice *devices = SupportedVendors[vendor].devices;</a>
<a name="ln498"> </a>
<a name="ln499">				while (devices-&gt;device_id) {</a>
<a name="ln500">					if (devices-&gt;device_id == pcii.device_id) {</a>
<a name="ln501">						rom_info ri;</a>
<a name="ln502"> </a>
<a name="ln503">						if (Radeon_MapBIOS(&amp;pcii, &amp;ri) == B_OK) {</a>
<a name="ln504">							Radeon_UnmapBIOS(&amp;ri);</a>
<a name="ln505"> </a>
<a name="ln506">							SHOW_INFO(0, &quot;found supported device&quot;</a>
<a name="ln507">								&quot; pci index %ld, device 0x%04x/0x%04x&quot;,</a>
<a name="ln508">								pci_index, pcii.vendor_id, pcii.device_id);</a>
<a name="ln509">							found_one = TRUE;</a>
<a name="ln510">							goto done;</a>
<a name="ln511">						}</a>
<a name="ln512">					}</a>
<a name="ln513">					devices++;</a>
<a name="ln514">				}</a>
<a name="ln515">			}</a>
<a name="ln516">			vendor++;</a>
<a name="ln517">		}</a>
<a name="ln518"> </a>
<a name="ln519">		pci_index++;</a>
<a name="ln520">	}</a>
<a name="ln521">	SHOW_INFO0(0, &quot;no supported devices found&quot;);</a>
<a name="ln522"> </a>
<a name="ln523">done:</a>
<a name="ln524">	put_module(B_PCI_MODULE_NAME);</a>
<a name="ln525"> </a>
<a name="ln526">	return (found_one ? B_OK : B_ERROR);</a>
<a name="ln527">}</a>
<a name="ln528"> </a>
<a name="ln529"> </a>
<a name="ln530">// !extend this array whenever a new ASIC is a added!</a>
<a name="ln531">static struct {</a>
<a name="ln532">	const char 		*name;			// name of ASIC</a>
<a name="ln533">	tv_chip_type	tv_chip;		// TV-Out chip (if any)</a>
<a name="ln534">	bool 			has_crtc2;		// has second CRTC</a>
<a name="ln535">	bool			has_vip;		// has VIP/I2C</a>
<a name="ln536">	bool			new_pll;		// reference divider of PPLL moved to other location</a>
<a name="ln537">} asic_properties[] =</a>
<a name="ln538">{</a>
<a name="ln539">	{ &quot;r100&quot;,	tc_external_rt1,	false,	true,	false},</a>
<a name="ln540">	{ &quot;rv100&quot;,	tc_internal_rt1, 	true,	true,	false},</a>
<a name="ln541">	{ &quot;rs100&quot;,	tc_internal_rt1,	true,	false,	false},</a>
<a name="ln542">	{ &quot;rv200&quot;,	tc_internal_rt2, 	true,	true,	false},</a>
<a name="ln543">	{ &quot;rs200&quot;,	tc_internal_rt1, 	true,	false,	false},</a>
<a name="ln544">	{ &quot;r200&quot;,	tc_external_rt1, 	true,	true,	false},</a>
<a name="ln545">	{ &quot;rv250&quot;,	tc_internal_rt2, 	true,	true,	false},</a>
<a name="ln546">	{ &quot;rs300&quot;,	tc_internal_rt1, 	true,	false,	false},</a>
<a name="ln547">	{ &quot;rv280&quot;,	tc_internal_rt2, 	true,	true,	false},</a>
<a name="ln548">	{ &quot;r300&quot;,	tc_internal_rt2, 	true,	true,	true },</a>
<a name="ln549">	{ &quot;r350&quot;,	tc_internal_rt2, 	true,	true,	true },</a>
<a name="ln550">	{ &quot;rv350&quot;,	tc_internal_rt2, 	true,	true,	true },</a>
<a name="ln551">	{ &quot;rv380&quot;,	tc_internal_rt2, 	true,	true,	true },</a>
<a name="ln552">	{ &quot;r420&quot;,	tc_internal_rt2, 	true,	true,	true }</a>
<a name="ln553"> </a>
<a name="ln554">};</a>
<a name="ln555"> </a>
<a name="ln556"> </a>
<a name="ln557">// get next supported device</a>
<a name="ln558">static bool probeDevice(device_info *di)</a>
<a name="ln559">{</a>
<a name="ln560">	int vendor;</a>
<a name="ln561"> </a>
<a name="ln562">	/* if we match a supported vendor */</a>
<a name="ln563">	for (vendor = 0; SupportedVendors[vendor].vendor_id; ++vendor) {</a>
<a name="ln564">		RadeonDevice *device;</a>
<a name="ln565"> </a>
<a name="ln566">		if (SupportedVendors[vendor].vendor_id != di-&gt;pcii.vendor_id)</a>
<a name="ln567">			continue;</a>
<a name="ln568"> </a>
<a name="ln569">		for (device = SupportedVendors[vendor].devices; device-&gt;device_id;</a>
<a name="ln570">			++device) {</a>
<a name="ln571">			// avoid double-detection</a>
<a name="ln572">			if (device-&gt;device_id != di-&gt;pcii.device_id)</a>
<a name="ln573">				continue;</a>
<a name="ln574"> </a>
<a name="ln575">			di-&gt;num_crtc = asic_properties[device-&gt;asic].has_crtc2 ? 2 : 1;</a>
<a name="ln576">			di-&gt;tv_chip = asic_properties[device-&gt;asic].tv_chip;</a>
<a name="ln577">			di-&gt;asic = device-&gt;asic;</a>
<a name="ln578">			di-&gt;is_mobility = (device-&gt;features &amp; ISMOBILITY) ? true : false;</a>
<a name="ln579">			di-&gt;has_vip = asic_properties[device-&gt;asic].has_vip;</a>
<a name="ln580">			di-&gt;new_pll = asic_properties[device-&gt;asic].new_pll;</a>
<a name="ln581">			di-&gt;is_igp = (device-&gt;features &amp; INTEGRATED) ? true : false;</a>
<a name="ln582"> </a>
<a name="ln583">			// detect chips with broken I2C</a>
<a name="ln584">			switch (device-&gt;device_id) {</a>
<a name="ln585">				case DEVICE_ID_RADEON_LY:</a>
<a name="ln586">				case DEVICE_ID_RADEON_LZ:</a>
<a name="ln587">				case DEVICE_ID_RADEON_LW:</a>
<a name="ln588">				case DEVICE_ID_RADEON_LX:</a>
<a name="ln589">				case DEVICE_ID_RADEON_If:</a>
<a name="ln590">				case DEVICE_ID_RADEON_Ig:</a>
<a name="ln591">				case DEVICE_ID_RADEON_5460:</a>
<a name="ln592">				case DEVICE_ID_RADEON_5464:</a>
<a name="ln593">					di-&gt;has_no_i2c = true;</a>
<a name="ln594">					break;</a>
<a name="ln595">				default:</a>
<a name="ln596">					di-&gt;has_no_i2c = false;</a>
<a name="ln597">			}</a>
<a name="ln598"> </a>
<a name="ln599">			// disable 2d DMA engine for chips that don't work with our</a>
<a name="ln600">			// dma code (yet).  I would have used asic type, but R410s are</a>
<a name="ln601">			// treated same asic as r420s in code, and the AGP x800 works fine.</a>
<a name="ln602">			switch (device-&gt;device_id) {</a>
<a name="ln603">				// rv370</a>
<a name="ln604">				case DEVICE_ID_RADEON_5b60:</a>
<a name="ln605">				case DEVICE_ID_RADEON_5b62:</a>
<a name="ln606">				case DEVICE_ID_RADEON_5b64:</a>
<a name="ln607">				case DEVICE_ID_RADEON_5b65:</a>
<a name="ln608">				case DEVICE_ID_RADEON_5460:</a>
<a name="ln609">				case DEVICE_ID_RADEON_5464:</a>
<a name="ln610"> </a>
<a name="ln611">				// rv380</a>
<a name="ln612">				case DEVICE_ID_RADEON_3e50:</a>
<a name="ln613">				case DEVICE_ID_RADEON_3e54:</a>
<a name="ln614">				case DEVICE_ID_RADEON_3150:</a>
<a name="ln615">				case DEVICE_ID_RADEON_3154:</a>
<a name="ln616">				case DEVICE_ID_RADEON_5462:</a>
<a name="ln617"> </a>
<a name="ln618">				// rv410</a>
<a name="ln619">				case DEVICE_ID_RADEON_5e48:</a>
<a name="ln620">				case DEVICE_ID_RADEON_564a:</a>
<a name="ln621">				case DEVICE_ID_RADEON_564b:</a>
<a name="ln622">				case DEVICE_ID_RADEON_564f:</a>
<a name="ln623">				case DEVICE_ID_RADEON_5652:</a>
<a name="ln624">				case DEVICE_ID_RADEON_5653:</a>
<a name="ln625">				case DEVICE_ID_RADEON_5e4b:</a>
<a name="ln626">				case DEVICE_ID_RADEON_5e4a:</a>
<a name="ln627">				case DEVICE_ID_RADEON_5e4d:</a>
<a name="ln628">				case DEVICE_ID_RADEON_5e4c:</a>
<a name="ln629">				case DEVICE_ID_RADEON_5e4f:</a>
<a name="ln630"> </a>
<a name="ln631">				// rs400</a>
<a name="ln632">				case DEVICE_ID_RS400_5a41:</a>
<a name="ln633">				case DEVICE_ID_RS400_5a42:</a>
<a name="ln634"> </a>
<a name="ln635">				// rs410</a>
<a name="ln636">				case DEVICE_ID_RS410_5a61:</a>
<a name="ln637">				case DEVICE_ID_RS410_5a62:</a>
<a name="ln638"> </a>
<a name="ln639">				// r430</a>
<a name="ln640">				case DEVICE_ID_RADEON_UM:</a>
<a name="ln641"> </a>
<a name="ln642">				// rs480</a>
<a name="ln643">				case DEVICE_ID_RS480_5954:</a>
<a name="ln644">				case DEVICE_ID_RS480_5955:</a>
<a name="ln645">				case DEVICE_ID_RS482_5974:</a>
<a name="ln646">				case DEVICE_ID_RS482_5975:</a>
<a name="ln647">					di-&gt;acc_dma = false;</a>
<a name="ln648">					break;</a>
<a name="ln649">				default:</a>
<a name="ln650">					di-&gt;acc_dma = true;</a>
<a name="ln651">					break;</a>
<a name="ln652">			}</a>
<a name="ln653"> </a>
<a name="ln654">			if (Radeon_MapBIOS(&amp;di-&gt;pcii, &amp;di-&gt;rom) != B_OK)</a>
<a name="ln655">				// give up checking this device - no BIOS, no fun</a>
<a name="ln656">				return false;</a>
<a name="ln657"> </a>
<a name="ln658">			if (Radeon_ReadBIOSData(di) != B_OK) {</a>
<a name="ln659">				Radeon_UnmapBIOS(&amp;di-&gt;rom);</a>
<a name="ln660">				return false;</a>
<a name="ln661">			}</a>
<a name="ln662"> </a>
<a name="ln663">			// we don't need BIOS any more</a>
<a name="ln664">			Radeon_UnmapBIOS(&amp;di-&gt;rom);</a>
<a name="ln665"> </a>
<a name="ln666">			SHOW_INFO(0, &quot;found %s; ASIC: %s&quot;, device-&gt;name,</a>
<a name="ln667">				asic_properties[device-&gt;asic].name);</a>
<a name="ln668"> </a>
<a name="ln669">			sprintf(di-&gt;name, &quot;graphics/%04X_%04X_%02X%02X%02X&quot;,</a>
<a name="ln670">				di-&gt;pcii.vendor_id, di-&gt;pcii.device_id,</a>
<a name="ln671">				di-&gt;pcii.bus, di-&gt;pcii.device, di-&gt;pcii.function);</a>
<a name="ln672">			SHOW_FLOW(3, &quot;making /dev/%s&quot;, di-&gt;name);</a>
<a name="ln673"> </a>
<a name="ln674">			// we always publish it as a video grabber; we should check for Rage</a>
<a name="ln675">			// Theater, but the corresponding code (vip.c) needs a fully</a>
<a name="ln676">			// initialized driver, and this is too much hazzly, so we leave it</a>
<a name="ln677">			// to the media add-on to verify that the card supports video-in</a>
<a name="ln678">			sprintf(di-&gt;video_name, &quot;video/radeon/%04X_%04X_%02X%02X%02X&quot;,</a>
<a name="ln679">				di-&gt;pcii.vendor_id, di-&gt;pcii.device_id,</a>
<a name="ln680">				di-&gt;pcii.bus, di-&gt;pcii.device, di-&gt;pcii.function);</a>
<a name="ln681"> </a>
<a name="ln682">			di-&gt;is_open = 0;</a>
<a name="ln683">			di-&gt;shared_area = -1;</a>
<a name="ln684">			di-&gt;si = NULL;</a>
<a name="ln685"> </a>
<a name="ln686">			return true;</a>
<a name="ln687">		}</a>
<a name="ln688">	}</a>
<a name="ln689"> </a>
<a name="ln690">	return false;</a>
<a name="ln691">}</a>
<a name="ln692"> </a>
<a name="ln693"> </a>
<a name="ln694">// gather list of supported devices</a>
<a name="ln695">// (currently, we rely on proper BIOS detection, which</a>
<a name="ln696">//  only works for primary graphics adapter, so multiple</a>
<a name="ln697">//  devices won't really work)</a>
<a name="ln698">void Radeon_ProbeDevices(void)</a>
<a name="ln699">{</a>
<a name="ln700">	uint32 pci_index = 0;</a>
<a name="ln701">	uint32 count = 0;</a>
<a name="ln702">	device_info *di = devices-&gt;di;</a>
<a name="ln703"> </a>
<a name="ln704">	while (count &lt; MAX_DEVICES) {</a>
<a name="ln705">		memset(di, 0, sizeof(*di));</a>
<a name="ln706"> </a>
<a name="ln707">		if ((*pci_bus-&gt;get_nth_pci_info)(pci_index, &amp;(di-&gt;pcii)) != B_NO_ERROR)</a>
<a name="ln708">			break;</a>
<a name="ln709"> </a>
<a name="ln710">		if (probeDevice(di)) {</a>
<a name="ln711">			devices-&gt;device_names[2 * count] = di-&gt;name;</a>
<a name="ln712">			devices-&gt;device_names[2 * count + 1] = di-&gt;video_name;</a>
<a name="ln713">			di++;</a>
<a name="ln714">			count++;</a>
<a name="ln715">		}</a>
<a name="ln716"> </a>
<a name="ln717">		pci_index++;</a>
<a name="ln718">	}</a>
<a name="ln719"> </a>
<a name="ln720">	devices-&gt;count = count;</a>
<a name="ln721">	devices-&gt;device_names[2 * count] = NULL;</a>
<a name="ln722"> </a>
<a name="ln723">	SHOW_INFO(0, &quot;%ld supported devices&quot;, count);</a>
<a name="ln724">}</a>

</code></pre>
<div class="balloon" rel="723"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v576/" target="_blank">V576</a> Incorrect format. Consider checking the fourth actual argument of the 'dprintf' function. The memsize type argument is expected.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
