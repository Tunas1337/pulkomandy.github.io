
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>Requests.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">// Requests.cpp</a>
<a name="ln2"> </a>
<a name="ln3">#include &lt;limits.h&gt;</a>
<a name="ln4"> </a>
<a name="ln5">#include &quot;Debug.h&quot;</a>
<a name="ln6">#include &quot;Requests.h&quot;</a>
<a name="ln7"> </a>
<a name="ln8">#define _ADD_ADDRESS(_address, _flags)				\</a>
<a name="ln9">	if (*count &gt;= MAX_REQUEST_ADDRESS_COUNT)		\</a>
<a name="ln10">		return B_BAD_VALUE;							\</a>
<a name="ln11">	infos[*count].address = &amp;_address;				\</a>
<a name="ln12">	infos[*count].flags = _flags;					\</a>
<a name="ln13">	infos[(*count)++].max_size = INT32_MAX;	// TODO:...</a>
<a name="ln14"> </a>
<a name="ln15">#define ADD_ADDRESS(address)	_ADD_ADDRESS(address, 0)</a>
<a name="ln16">#define ADD_STRING(address)		_ADD_ADDRESS(address, ADDRESS_IS_STRING)</a>
<a name="ln17">#define ADD_NON_NULL_ADDRESS(address)	_ADD_ADDRESS(address, ADDRESS_NOT_NULL)</a>
<a name="ln18">#define ADD_NON_NULL_STRING(address)	\</a>
<a name="ln19">	_ADD_ADDRESS(address, (ADDRESS_IS_STRING | ADDRESS_NOT_NULL))</a>
<a name="ln20"> </a>
<a name="ln21">// FSConnectRequest</a>
<a name="ln22">status_t</a>
<a name="ln23">FSConnectRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln24">{</a>
<a name="ln25">	ADD_NON_NULL_STRING(fsName);</a>
<a name="ln26">	return B_OK;</a>
<a name="ln27">}</a>
<a name="ln28"> </a>
<a name="ln29">// FSConnectReply</a>
<a name="ln30">status_t</a>
<a name="ln31">FSConnectReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln32">{</a>
<a name="ln33">	ADD_NON_NULL_ADDRESS(portInfos);</a>
<a name="ln34">	return B_OK;</a>
<a name="ln35">}</a>
<a name="ln36"> </a>
<a name="ln37">// MountVolumeRequest</a>
<a name="ln38">status_t</a>
<a name="ln39">MountVolumeRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln40">{</a>
<a name="ln41">	ADD_NON_NULL_STRING(cwd);</a>
<a name="ln42">	ADD_STRING(device);</a>
<a name="ln43">	ADD_STRING(parameters);</a>
<a name="ln44">	return B_OK;</a>
<a name="ln45">}</a>
<a name="ln46"> </a>
<a name="ln47">//// InitializeVolumeRequest</a>
<a name="ln48">//status_t</a>
<a name="ln49">//InitializeVolumeRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln50">//{</a>
<a name="ln51">//	ADD_STRING(device);</a>
<a name="ln52">//	ADD_STRING(parameters);</a>
<a name="ln53">//	return B_OK;</a>
<a name="ln54">//}</a>
<a name="ln55"> </a>
<a name="ln56">// GetVNodeNameReply</a>
<a name="ln57">status_t</a>
<a name="ln58">GetVNodeNameReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln59">{</a>
<a name="ln60">	ADD_STRING(buffer);</a>
<a name="ln61">	return B_OK;</a>
<a name="ln62">}</a>
<a name="ln63"> </a>
<a name="ln64">// CreateRequest</a>
<a name="ln65">status_t</a>
<a name="ln66">CreateRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln67">{</a>
<a name="ln68">	ADD_NON_NULL_STRING(name);</a>
<a name="ln69">	return B_OK;</a>
<a name="ln70">}</a>
<a name="ln71"> </a>
<a name="ln72">// ReadReply</a>
<a name="ln73">status_t</a>
<a name="ln74">ReadReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln75">{</a>
<a name="ln76">	ADD_ADDRESS(buffer);</a>
<a name="ln77">	return B_OK;</a>
<a name="ln78">}</a>
<a name="ln79"> </a>
<a name="ln80">// WriteRequest</a>
<a name="ln81">status_t</a>
<a name="ln82">WriteRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln83">{</a>
<a name="ln84">	ADD_ADDRESS(buffer);</a>
<a name="ln85">	return B_OK;</a>
<a name="ln86">}</a>
<a name="ln87"> </a>
<a name="ln88">// IOCtlRequest</a>
<a name="ln89">status_t</a>
<a name="ln90">IOCtlRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln91">{</a>
<a name="ln92">	ADD_ADDRESS(buffer);</a>
<a name="ln93">	return B_OK;</a>
<a name="ln94">}</a>
<a name="ln95"> </a>
<a name="ln96">// IOCtlReply</a>
<a name="ln97">status_t</a>
<a name="ln98">IOCtlReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln99">{</a>
<a name="ln100">	ADD_ADDRESS(buffer);</a>
<a name="ln101">	return B_OK;</a>
<a name="ln102">}</a>
<a name="ln103"> </a>
<a name="ln104">// LinkRequest</a>
<a name="ln105">status_t</a>
<a name="ln106">LinkRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln107">{</a>
<a name="ln108">	ADD_NON_NULL_STRING(name);</a>
<a name="ln109">	return B_OK;</a>
<a name="ln110">}</a>
<a name="ln111"> </a>
<a name="ln112">// UnlinkRequest</a>
<a name="ln113">status_t</a>
<a name="ln114">UnlinkRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln115">{</a>
<a name="ln116">	ADD_NON_NULL_STRING(name);</a>
<a name="ln117">	return B_OK;</a>
<a name="ln118">}</a>
<a name="ln119"> </a>
<a name="ln120">// CreateSymlinkRequest</a>
<a name="ln121">status_t</a>
<a name="ln122">CreateSymlinkRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln123">{</a>
<a name="ln124">	ADD_NON_NULL_STRING(name);</a>
<a name="ln125">	ADD_NON_NULL_STRING(target);</a>
<a name="ln126">	return B_OK;</a>
<a name="ln127">}</a>
<a name="ln128"> </a>
<a name="ln129">// ReadSymlinkReply</a>
<a name="ln130">status_t</a>
<a name="ln131">ReadSymlinkReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln132">{</a>
<a name="ln133">	ADD_STRING(buffer);</a>
<a name="ln134">	return B_OK;</a>
<a name="ln135">}</a>
<a name="ln136"> </a>
<a name="ln137">// RenameRequest</a>
<a name="ln138">status_t</a>
<a name="ln139">RenameRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln140">{</a>
<a name="ln141">	ADD_NON_NULL_STRING(oldName);</a>
<a name="ln142">	ADD_NON_NULL_STRING(newName);</a>
<a name="ln143">	return B_OK;</a>
<a name="ln144">}</a>
<a name="ln145"> </a>
<a name="ln146">// CreateDirRequest</a>
<a name="ln147">status_t</a>
<a name="ln148">CreateDirRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln149">{</a>
<a name="ln150">	ADD_NON_NULL_STRING(name);</a>
<a name="ln151">	return B_OK;</a>
<a name="ln152">}</a>
<a name="ln153"> </a>
<a name="ln154">// RemoveDirRequest</a>
<a name="ln155">status_t</a>
<a name="ln156">RemoveDirRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln157">{</a>
<a name="ln158">	ADD_NON_NULL_STRING(name);</a>
<a name="ln159">	return B_OK;</a>
<a name="ln160">}</a>
<a name="ln161"> </a>
<a name="ln162">// ReadDirReply</a>
<a name="ln163">status_t</a>
<a name="ln164">ReadDirReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln165">{</a>
<a name="ln166">	ADD_ADDRESS(buffer);</a>
<a name="ln167">	return B_OK;</a>
<a name="ln168">}</a>
<a name="ln169"> </a>
<a name="ln170">// LookupRequest</a>
<a name="ln171">status_t</a>
<a name="ln172">LookupRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln173">{</a>
<a name="ln174">	ADD_NON_NULL_STRING(entryName);</a>
<a name="ln175">	return B_OK;</a>
<a name="ln176">}</a>
<a name="ln177"> </a>
<a name="ln178">// ReadAttrDirReply</a>
<a name="ln179">status_t</a>
<a name="ln180">ReadAttrDirReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln181">{</a>
<a name="ln182">	ADD_ADDRESS(buffer);</a>
<a name="ln183">	return B_OK;</a>
<a name="ln184">}</a>
<a name="ln185"> </a>
<a name="ln186">// CreateAttrRequest</a>
<a name="ln187">status_t</a>
<a name="ln188">CreateAttrRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln189">{</a>
<a name="ln190">	ADD_NON_NULL_STRING(name);</a>
<a name="ln191">	return B_OK;</a>
<a name="ln192">}</a>
<a name="ln193"> </a>
<a name="ln194">// OpenAttrRequest</a>
<a name="ln195">status_t</a>
<a name="ln196">OpenAttrRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln197">{</a>
<a name="ln198">	ADD_NON_NULL_STRING(name);</a>
<a name="ln199">	return B_OK;</a>
<a name="ln200">}</a>
<a name="ln201"> </a>
<a name="ln202">// ReadAttrReply</a>
<a name="ln203">status_t</a>
<a name="ln204">ReadAttrReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln205">{</a>
<a name="ln206">	ADD_ADDRESS(buffer);</a>
<a name="ln207">	return B_OK;</a>
<a name="ln208">}</a>
<a name="ln209"> </a>
<a name="ln210">// WriteAttrRequest</a>
<a name="ln211">status_t</a>
<a name="ln212">WriteAttrRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln213">{</a>
<a name="ln214">	ADD_ADDRESS(buffer);</a>
<a name="ln215">	return B_OK;</a>
<a name="ln216">}</a>
<a name="ln217"> </a>
<a name="ln218">// RemoveAttrRequest</a>
<a name="ln219">status_t</a>
<a name="ln220">RemoveAttrRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln221">{</a>
<a name="ln222">	ADD_NON_NULL_STRING(name);</a>
<a name="ln223">	return B_OK;</a>
<a name="ln224">}</a>
<a name="ln225"> </a>
<a name="ln226">// RenameAttrRequest</a>
<a name="ln227">status_t</a>
<a name="ln228">RenameAttrRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln229">{</a>
<a name="ln230">	ADD_NON_NULL_STRING(oldName);</a>
<a name="ln231">	ADD_NON_NULL_STRING(newName);</a>
<a name="ln232">	return B_OK;</a>
<a name="ln233">}</a>
<a name="ln234"> </a>
<a name="ln235">// ReadIndexDirReply</a>
<a name="ln236">status_t</a>
<a name="ln237">ReadIndexDirReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln238">{</a>
<a name="ln239">	ADD_ADDRESS(buffer);</a>
<a name="ln240">	return B_OK;</a>
<a name="ln241">}</a>
<a name="ln242"> </a>
<a name="ln243">// CreateIndexRequest</a>
<a name="ln244">status_t</a>
<a name="ln245">CreateIndexRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln246">{</a>
<a name="ln247">	ADD_NON_NULL_STRING(name);</a>
<a name="ln248">	return B_OK;</a>
<a name="ln249">}</a>
<a name="ln250"> </a>
<a name="ln251">// RemoveIndexRequest</a>
<a name="ln252">status_t</a>
<a name="ln253">RemoveIndexRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln254">{</a>
<a name="ln255">	ADD_NON_NULL_STRING(name);</a>
<a name="ln256">	return B_OK;</a>
<a name="ln257">}</a>
<a name="ln258"> </a>
<a name="ln259">// ReadIndexStatRequest</a>
<a name="ln260">status_t</a>
<a name="ln261">ReadIndexStatRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln262">{</a>
<a name="ln263">	ADD_NON_NULL_STRING(name);</a>
<a name="ln264">	return B_OK;</a>
<a name="ln265">}</a>
<a name="ln266"> </a>
<a name="ln267">// OpenQueryRequest</a>
<a name="ln268">status_t</a>
<a name="ln269">OpenQueryRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln270">{</a>
<a name="ln271">	ADD_NON_NULL_STRING(queryString);</a>
<a name="ln272">	return B_OK;</a>
<a name="ln273">}</a>
<a name="ln274"> </a>
<a name="ln275">// ReadQueryReply</a>
<a name="ln276">status_t</a>
<a name="ln277">ReadQueryReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln278">{</a>
<a name="ln279">	ADD_ADDRESS(buffer);</a>
<a name="ln280">	return B_OK;</a>
<a name="ln281">}</a>
<a name="ln282"> </a>
<a name="ln283">// NodeMonitoringEventRequest</a>
<a name="ln284">status_t</a>
<a name="ln285">NodeMonitoringEventRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln286">{</a>
<a name="ln287">	ADD_ADDRESS(event);</a>
<a name="ln288">	return B_OK;</a>
<a name="ln289">}</a>
<a name="ln290"> </a>
<a name="ln291">// NotifyListenerRequest</a>
<a name="ln292">status_t</a>
<a name="ln293">NotifyListenerRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln294">{</a>
<a name="ln295">	ADD_STRING(oldName);</a>
<a name="ln296">	ADD_STRING(name);</a>
<a name="ln297">	return B_OK;</a>
<a name="ln298">}</a>
<a name="ln299"> </a>
<a name="ln300">// NotifyQueryRequest</a>
<a name="ln301">status_t</a>
<a name="ln302">NotifyQueryRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln303">{</a>
<a name="ln304">	ADD_STRING(name);</a>
<a name="ln305">	return B_OK;</a>
<a name="ln306">}</a>
<a name="ln307"> </a>
<a name="ln308">// FileCacheReadReply</a>
<a name="ln309">status_t</a>
<a name="ln310">FileCacheReadReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln311">{</a>
<a name="ln312">	ADD_ADDRESS(buffer);</a>
<a name="ln313">	return B_OK;</a>
<a name="ln314">}</a>
<a name="ln315"> </a>
<a name="ln316">// FileCacheWriteRequest</a>
<a name="ln317">status_t</a>
<a name="ln318">FileCacheWriteRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln319">{</a>
<a name="ln320">	ADD_ADDRESS(buffer);</a>
<a name="ln321">	return B_OK;</a>
<a name="ln322">}</a>
<a name="ln323"> </a>
<a name="ln324">// ReadFromIORequestReply</a>
<a name="ln325">status_t</a>
<a name="ln326">ReadFromIORequestReply::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln327">{</a>
<a name="ln328">	ADD_ADDRESS(buffer);</a>
<a name="ln329">	return B_OK;</a>
<a name="ln330">}</a>
<a name="ln331"> </a>
<a name="ln332">// WriteToIORequestRequest</a>
<a name="ln333">status_t</a>
<a name="ln334">WriteToIORequestRequest::GetAddressInfos(AddressInfo* infos, int32* count)</a>
<a name="ln335">{</a>
<a name="ln336">	ADD_ADDRESS(buffer);</a>
<a name="ln337">	return B_OK;</a>
<a name="ln338">}</a>
<a name="ln339"> </a>
<a name="ln340"> </a>
<a name="ln341">// #pragma mark -</a>
<a name="ln342"> </a>
<a name="ln343">// RequestAddressInfoGetter</a>
<a name="ln344">struct RequestAddressInfoGetter {</a>
<a name="ln345">	RequestAddressInfoGetter(AddressInfo* infos, int32* count)</a>
<a name="ln346">		: fInfos(infos),</a>
<a name="ln347">		  fCount(count)</a>
<a name="ln348">	{</a>
<a name="ln349">	}</a>
<a name="ln350"> </a>
<a name="ln351">	template&lt;typename R&gt; status_t operator()(R* request)</a>
<a name="ln352">	{</a>
<a name="ln353">		return request-&gt;GetAddressInfos(fInfos, fCount);</a>
<a name="ln354">	}</a>
<a name="ln355"> </a>
<a name="ln356">private:</a>
<a name="ln357">	AddressInfo*	fInfos;</a>
<a name="ln358">	int32*			fCount;</a>
<a name="ln359">};</a>
<a name="ln360"> </a>
<a name="ln361">// get_request_address_infos</a>
<a name="ln362">status_t</a>
<a name="ln363">UserlandFSUtil::get_request_address_infos(Request* request, AddressInfo* infos,</a>
<a name="ln364">	int32* count)</a>
<a name="ln365">{</a>
<a name="ln366">	if (!infos || !count)</a>
<a name="ln367">		return B_BAD_VALUE;</a>
<a name="ln368">	*count = 0;</a>
<a name="ln369">	RequestAddressInfoGetter task(infos, count);</a>
<a name="ln370">	return do_for_request(request, task);</a>
<a name="ln371">}</a>
<a name="ln372"> </a>
<a name="ln373">// RequestChecker</a>
<a name="ln374">struct RequestChecker {</a>
<a name="ln375">	template&lt;typename R&gt; status_t operator()(R* request)</a>
<a name="ln376">	{</a>
<a name="ln377">		return request-&gt;Check();</a>
<a name="ln378">	}</a>
<a name="ln379">};</a>
<a name="ln380"> </a>
<a name="ln381">// check_request</a>
<a name="ln382">status_t</a>
<a name="ln383">UserlandFSUtil::check_request(Request* request)</a>
<a name="ln384">{</a>
<a name="ln385">	RequestChecker task;</a>
<a name="ln386">	return do_for_request(request, task);</a>
<a name="ln387">}</a>
<a name="ln388"> </a>
<a name="ln389"> </a>
<a name="ln390">// is_error_reply</a>
<a name="ln391">static inline</a>
<a name="ln392">bool</a>
<a name="ln393">is_error_reply(Request* request)</a>
<a name="ln394">{</a>
<a name="ln395">	return false;</a>
<a name="ln396">}</a>
<a name="ln397"> </a>
<a name="ln398">// is_error_reply</a>
<a name="ln399">static inline</a>
<a name="ln400">bool</a>
<a name="ln401">is_error_reply(ReplyRequest* request)</a>
<a name="ln402">{</a>
<a name="ln403">	return (request-&gt;error != B_OK);</a>
<a name="ln404">}</a>
<a name="ln405"> </a>
<a name="ln406">// RequestRelocator</a>
<a name="ln407">struct RequestRelocator {</a>
<a name="ln408">	RequestRelocator(int32 requestBufferSize, area_id* areas, int32* count)</a>
<a name="ln409">		: fRequestBufferSize(requestBufferSize),</a>
<a name="ln410">		  fAreas(areas),</a>
<a name="ln411">		  fAreaCount(count)</a>
<a name="ln412">	{</a>
<a name="ln413">		*fAreaCount = 0;</a>
<a name="ln414">	}</a>
<a name="ln415"> </a>
<a name="ln416">	~RequestRelocator()</a>
<a name="ln417">	{</a>
<a name="ln418">		if (!fSuccess) {</a>
<a name="ln419">			for (int32 i = 0; i &lt; *fAreaCount; i++)</a>
<a name="ln420">				delete_area(fAreas[i]);</a>
<a name="ln421">		}</a>
<a name="ln422">	}</a>
<a name="ln423"> </a>
<a name="ln424">	template&lt;typename R&gt; status_t operator()(R* request)</a>
<a name="ln425">	{</a>
<a name="ln426">		// check the request buffer size</a>
<a name="ln427">		if (fRequestBufferSize &lt; (int32)sizeof(R))</a>
<a name="ln428">			RETURN_ERROR(B_BAD_DATA);</a>
<a name="ln429">		// no need to relocate the addresses of a reply that indicates an error</a>
<a name="ln430">		if (is_error_reply(request)) {</a>
<a name="ln431">			fSuccess = true;</a>
<a name="ln432">			return B_OK;</a>
<a name="ln433">		}</a>
<a name="ln434">		// get the address infos</a>
<a name="ln435">		AddressInfo infos[MAX_REQUEST_ADDRESS_COUNT];</a>
<a name="ln436">		int32 count = 0;</a>
<a name="ln437">		status_t error = request-&gt;GetAddressInfos(infos, &amp;count);</a>
<a name="ln438">		if (error != B_OK)</a>
<a name="ln439">			RETURN_ERROR(error);</a>
<a name="ln440">		// check and relocate the addresses</a>
<a name="ln441">		for (int32 i = 0; i &lt; count; i++) {</a>
<a name="ln442">			// check</a>
<a name="ln443">			Address* address = infos[i].address;</a>
<a name="ln444">			int32 size = address-&gt;GetSize();</a>
<a name="ln445">			int32 offset = address-&gt;GetOffset();</a>
<a name="ln446">//PRINT((&quot;  relocating address: area: %ld, offset: %ld, size: %ld...\n&quot;,</a>
<a name="ln447">//address-&gt;GetArea(), offset, size));</a>
<a name="ln448">			if (offset &lt; 0 || size &lt; 0 || size &gt; infos[i].max_size)</a>
<a name="ln449">				RETURN_ERROR(B_BAD_DATA);</a>
<a name="ln450">			if ((infos[i].flags &amp; ADDRESS_NOT_NULL) &amp;&amp; size == 0)</a>
<a name="ln451">				RETURN_ERROR(B_BAD_DATA);</a>
<a name="ln452">			// relocate</a>
<a name="ln453">			area_id area = address-&gt;GetArea();</a>
<a name="ln454">			if (area &lt; 0) {</a>
<a name="ln455">				// data in the buffer itself</a>
<a name="ln456">				if (offset == 0 &amp;&amp; size == 0) {</a>
<a name="ln457">//PRINT((&quot;    -&gt; relocated address: NULL\n&quot;));</a>
<a name="ln458">					address-&gt;SetRelocatedAddress(NULL);</a>
<a name="ln459">				} else {</a>
<a name="ln460">					if (offset &lt; (int32)sizeof(R)</a>
<a name="ln461">						|| offset + size &gt; fRequestBufferSize) {</a>
<a name="ln462">						RETURN_ERROR(B_BAD_DATA);</a>
<a name="ln463">					}</a>
<a name="ln464">//PRINT((&quot;    -&gt; relocated address: %p\n&quot;, (uint8*)request + offset));</a>
<a name="ln465">					address-&gt;SetRelocatedAddress((uint8*)request + offset);</a>
<a name="ln466">				}</a>
<a name="ln467">			} else {</a>
<a name="ln468">				// clone the area</a>
<a name="ln469">				void* data;</a>
<a name="ln470">				area = clone_area(&quot;cloned request data&quot;, &amp;data,</a>
<a name="ln471">#ifdef _KERNEL_MODE</a>
<a name="ln472">					B_ANY_KERNEL_ADDRESS, B_KERNEL_READ_AREA,</a>
<a name="ln473">#else</a>
<a name="ln474">					B_ANY_ADDRESS, B_READ_AREA,</a>
<a name="ln475">#endif</a>
<a name="ln476">					area);</a>
<a name="ln477">				if (area &lt; 0)</a>
<a name="ln478">					RETURN_ERROR(area);</a>
<a name="ln479">				fAreas[(*fAreaCount)++] = area;</a>
<a name="ln480">				// check offset and size</a>
<a name="ln481">				area_info areaInfo;</a>
<a name="ln482">				error = get_area_info(area, &amp;areaInfo);</a>
<a name="ln483">				if (error != B_OK)</a>
<a name="ln484">					RETURN_ERROR(error);</a>
<a name="ln485">				if (offset + size &gt; (int32)areaInfo.size)</a>
<a name="ln486">					RETURN_ERROR(B_BAD_DATA);</a>
<a name="ln487">//PRINT((&quot;    -&gt; relocated address: %p\n&quot;, (uint8*)data + offset));</a>
<a name="ln488">				address-&gt;SetRelocatedAddress((uint8*)data + offset);</a>
<a name="ln489">			}</a>
<a name="ln490">		}</a>
<a name="ln491">		// finally let the request check its integrity</a>
<a name="ln492">		error = request-&gt;Check();</a>
<a name="ln493">		if (error != B_OK)</a>
<a name="ln494">			RETURN_ERROR(error);</a>
<a name="ln495">		fSuccess = true;</a>
<a name="ln496">//PRINT((&quot;RequestRelocator done: success\n&quot;));</a>
<a name="ln497">		return B_OK;</a>
<a name="ln498">	}</a>
<a name="ln499"> </a>
<a name="ln500">private:</a>
<a name="ln501">	int32		fRequestBufferSize;</a>
<a name="ln502">	area_id*	fAreas;</a>
<a name="ln503">	int32*		fAreaCount;</a>
<a name="ln504">	bool		fSuccess;</a>
<a name="ln505">};</a>
<a name="ln506"> </a>
<a name="ln507">// relocate_request</a>
<a name="ln508">status_t</a>
<a name="ln509">UserlandFSUtil::relocate_request(Request* request, int32 requestBufferSize,</a>
<a name="ln510">	area_id* areas, int32* count)</a>
<a name="ln511">{</a>
<a name="ln512">	if (!request || !areas || !count)</a>
<a name="ln513">		return B_BAD_VALUE;</a>
<a name="ln514">	RequestRelocator task(requestBufferSize, areas, count);</a>
<a name="ln515">	return do_for_request(request, task);</a>
<a name="ln516">}</a>
<a name="ln517"> </a>
<a name="ln518">// is_kernel_request</a>
<a name="ln519">bool</a>
<a name="ln520">UserlandFSUtil::is_kernel_request(uint32 type)</a>
<a name="ln521">{</a>
<a name="ln522">	switch (type) {</a>
<a name="ln523">		// kernel -&gt; userland requests</a>
<a name="ln524">		// administrative</a>
<a name="ln525">		case UFS_DISCONNECT_REQUEST:</a>
<a name="ln526">		case FS_CONNECT_REQUEST:</a>
<a name="ln527">			return true;</a>
<a name="ln528">		case FS_CONNECT_REPLY:</a>
<a name="ln529">			return false;</a>
<a name="ln530">		// FS</a>
<a name="ln531">		case MOUNT_VOLUME_REQUEST:</a>
<a name="ln532">		case UNMOUNT_VOLUME_REQUEST:</a>
<a name="ln533">//		case INITIALIZE_VOLUME_REQUEST:</a>
<a name="ln534">		case SYNC_VOLUME_REQUEST:</a>
<a name="ln535">		case READ_FS_INFO_REQUEST:</a>
<a name="ln536">		case WRITE_FS_INFO_REQUEST:</a>
<a name="ln537">			return true;</a>
<a name="ln538">		case MOUNT_VOLUME_REPLY:</a>
<a name="ln539">		case UNMOUNT_VOLUME_REPLY:</a>
<a name="ln540">//		case INITIALIZE_VOLUME_REPLY:</a>
<a name="ln541">		case SYNC_VOLUME_REPLY:</a>
<a name="ln542">		case READ_FS_INFO_REPLY:</a>
<a name="ln543">		case WRITE_FS_INFO_REPLY:</a>
<a name="ln544">			return false;</a>
<a name="ln545">		// vnodes</a>
<a name="ln546">		case LOOKUP_REQUEST:</a>
<a name="ln547">		case GET_VNODE_NAME_REQUEST:</a>
<a name="ln548">		case READ_VNODE_REQUEST:</a>
<a name="ln549">		case WRITE_VNODE_REQUEST:</a>
<a name="ln550">		case FS_REMOVE_VNODE_REQUEST:</a>
<a name="ln551">			return true;</a>
<a name="ln552">		case LOOKUP_REPLY:</a>
<a name="ln553">		case GET_VNODE_NAME_REPLY:</a>
<a name="ln554">		case READ_VNODE_REPLY:</a>
<a name="ln555">		case WRITE_VNODE_REPLY:</a>
<a name="ln556">		case FS_REMOVE_VNODE_REPLY:</a>
<a name="ln557">			return false;</a>
<a name="ln558">		// asynchronous I/O</a>
<a name="ln559">		case DO_IO_REQUEST:</a>
<a name="ln560">		case CANCEL_IO_REQUEST:</a>
<a name="ln561">		case ITERATIVE_IO_GET_VECS_REQUEST:</a>
<a name="ln562">		case ITERATIVE_IO_FINISHED_REQUEST:</a>
<a name="ln563">			return true;</a>
<a name="ln564">		case DO_IO_REPLY:</a>
<a name="ln565">		case CANCEL_IO_REPLY:</a>
<a name="ln566">		case ITERATIVE_IO_GET_VECS_REPLY:</a>
<a name="ln567">		case ITERATIVE_IO_FINISHED_REPLY:</a>
<a name="ln568">			return false;</a>
<a name="ln569">		// nodes</a>
<a name="ln570">		case IOCTL_REQUEST:</a>
<a name="ln571">		case SET_FLAGS_REQUEST:</a>
<a name="ln572">		case SELECT_REQUEST:</a>
<a name="ln573">		case DESELECT_REQUEST:</a>
<a name="ln574">		case FSYNC_REQUEST:</a>
<a name="ln575">		case READ_SYMLINK_REQUEST:</a>
<a name="ln576">		case CREATE_SYMLINK_REQUEST:</a>
<a name="ln577">		case LINK_REQUEST:</a>
<a name="ln578">		case UNLINK_REQUEST:</a>
<a name="ln579">		case RENAME_REQUEST:</a>
<a name="ln580">		case ACCESS_REQUEST:</a>
<a name="ln581">		case READ_STAT_REQUEST:</a>
<a name="ln582">		case WRITE_STAT_REQUEST:</a>
<a name="ln583">			return true;</a>
<a name="ln584">		case IOCTL_REPLY:</a>
<a name="ln585">		case SET_FLAGS_REPLY:</a>
<a name="ln586">		case SELECT_REPLY:</a>
<a name="ln587">		case DESELECT_REPLY:</a>
<a name="ln588">		case FSYNC_REPLY:</a>
<a name="ln589">		case READ_SYMLINK_REPLY:</a>
<a name="ln590">		case CREATE_SYMLINK_REPLY:</a>
<a name="ln591">		case LINK_REPLY:</a>
<a name="ln592">		case UNLINK_REPLY:</a>
<a name="ln593">		case RENAME_REPLY:</a>
<a name="ln594">		case ACCESS_REPLY:</a>
<a name="ln595">		case READ_STAT_REPLY:</a>
<a name="ln596">		case WRITE_STAT_REPLY:</a>
<a name="ln597">			return false;</a>
<a name="ln598">		// files</a>
<a name="ln599">		case CREATE_REQUEST:</a>
<a name="ln600">		case OPEN_REQUEST:</a>
<a name="ln601">		case CLOSE_REQUEST:</a>
<a name="ln602">		case FREE_COOKIE_REQUEST:</a>
<a name="ln603">		case READ_REQUEST:</a>
<a name="ln604">		case WRITE_REQUEST:</a>
<a name="ln605">			return true;</a>
<a name="ln606">		case CREATE_REPLY:</a>
<a name="ln607">		case OPEN_REPLY:</a>
<a name="ln608">		case CLOSE_REPLY:</a>
<a name="ln609">		case FREE_COOKIE_REPLY:</a>
<a name="ln610">		case READ_REPLY:</a>
<a name="ln611">		case WRITE_REPLY:</a>
<a name="ln612">			return false;</a>
<a name="ln613">		// directories</a>
<a name="ln614">		case CREATE_DIR_REQUEST:</a>
<a name="ln615">		case REMOVE_DIR_REQUEST:</a>
<a name="ln616">		case OPEN_DIR_REQUEST:</a>
<a name="ln617">		case CLOSE_DIR_REQUEST:</a>
<a name="ln618">		case FREE_DIR_COOKIE_REQUEST:</a>
<a name="ln619">		case READ_DIR_REQUEST:</a>
<a name="ln620">		case REWIND_DIR_REQUEST:</a>
<a name="ln621">			return true;</a>
<a name="ln622">		case CREATE_DIR_REPLY:</a>
<a name="ln623">		case REMOVE_DIR_REPLY:</a>
<a name="ln624">		case OPEN_DIR_REPLY:</a>
<a name="ln625">		case CLOSE_DIR_REPLY:</a>
<a name="ln626">		case FREE_DIR_COOKIE_REPLY:</a>
<a name="ln627">		case READ_DIR_REPLY:</a>
<a name="ln628">		case REWIND_DIR_REPLY:</a>
<a name="ln629">			return false;</a>
<a name="ln630">		// attribute directories</a>
<a name="ln631">		case OPEN_ATTR_DIR_REQUEST:</a>
<a name="ln632">		case CLOSE_ATTR_DIR_REQUEST:</a>
<a name="ln633">		case FREE_ATTR_DIR_COOKIE_REQUEST:</a>
<a name="ln634">		case READ_ATTR_DIR_REQUEST:</a>
<a name="ln635">		case REWIND_ATTR_DIR_REQUEST:</a>
<a name="ln636">			return true;</a>
<a name="ln637">		case OPEN_ATTR_DIR_REPLY:</a>
<a name="ln638">		case CLOSE_ATTR_DIR_REPLY:</a>
<a name="ln639">		case FREE_ATTR_DIR_COOKIE_REPLY:</a>
<a name="ln640">		case READ_ATTR_DIR_REPLY:</a>
<a name="ln641">		case REWIND_ATTR_DIR_REPLY:</a>
<a name="ln642">			return false;</a>
<a name="ln643">		// attributes</a>
<a name="ln644">		case CREATE_ATTR_REQUEST:</a>
<a name="ln645">		case OPEN_ATTR_REQUEST:</a>
<a name="ln646">		case CLOSE_ATTR_REQUEST:</a>
<a name="ln647">		case FREE_ATTR_COOKIE_REQUEST:</a>
<a name="ln648">		case READ_ATTR_REQUEST:</a>
<a name="ln649">		case WRITE_ATTR_REQUEST:</a>
<a name="ln650">		case READ_ATTR_STAT_REQUEST:</a>
<a name="ln651">		case WRITE_ATTR_STAT_REQUEST:</a>
<a name="ln652">		case RENAME_ATTR_REQUEST:</a>
<a name="ln653">		case REMOVE_ATTR_REQUEST:</a>
<a name="ln654">			return true;</a>
<a name="ln655">		case CREATE_ATTR_REPLY:</a>
<a name="ln656">		case OPEN_ATTR_REPLY:</a>
<a name="ln657">		case CLOSE_ATTR_REPLY:</a>
<a name="ln658">		case FREE_ATTR_COOKIE_REPLY:</a>
<a name="ln659">		case READ_ATTR_REPLY:</a>
<a name="ln660">		case WRITE_ATTR_REPLY:</a>
<a name="ln661">		case READ_ATTR_STAT_REPLY:</a>
<a name="ln662">		case WRITE_ATTR_STAT_REPLY:</a>
<a name="ln663">		case RENAME_ATTR_REPLY:</a>
<a name="ln664">		case REMOVE_ATTR_REPLY:</a>
<a name="ln665">			return false;</a>
<a name="ln666">		// indices</a>
<a name="ln667">		case OPEN_INDEX_DIR_REQUEST:</a>
<a name="ln668">		case CLOSE_INDEX_DIR_REQUEST:</a>
<a name="ln669">		case FREE_INDEX_DIR_COOKIE_REQUEST:</a>
<a name="ln670">		case READ_INDEX_DIR_REQUEST:</a>
<a name="ln671">		case REWIND_INDEX_DIR_REQUEST:</a>
<a name="ln672">		case CREATE_INDEX_REQUEST:</a>
<a name="ln673">		case REMOVE_INDEX_REQUEST:</a>
<a name="ln674">		case READ_INDEX_STAT_REQUEST:</a>
<a name="ln675">			return true;</a>
<a name="ln676">		case OPEN_INDEX_DIR_REPLY:</a>
<a name="ln677">		case CLOSE_INDEX_DIR_REPLY:</a>
<a name="ln678">		case FREE_INDEX_DIR_COOKIE_REPLY:</a>
<a name="ln679">		case READ_INDEX_DIR_REPLY:</a>
<a name="ln680">		case REWIND_INDEX_DIR_REPLY:</a>
<a name="ln681">		case CREATE_INDEX_REPLY:</a>
<a name="ln682">		case REMOVE_INDEX_REPLY:</a>
<a name="ln683">		case READ_INDEX_STAT_REPLY:</a>
<a name="ln684">			return false;</a>
<a name="ln685">		// queries</a>
<a name="ln686">		case OPEN_QUERY_REQUEST:</a>
<a name="ln687">		case CLOSE_QUERY_REQUEST:</a>
<a name="ln688">		case FREE_QUERY_COOKIE_REQUEST:</a>
<a name="ln689">		case READ_QUERY_REQUEST:</a>
<a name="ln690">		case REWIND_QUERY_REQUEST:</a>
<a name="ln691">			return true;</a>
<a name="ln692">		case OPEN_QUERY_REPLY:</a>
<a name="ln693">		case CLOSE_QUERY_REPLY:</a>
<a name="ln694">		case FREE_QUERY_COOKIE_REPLY:</a>
<a name="ln695">		case READ_QUERY_REPLY:</a>
<a name="ln696">		case REWIND_QUERY_REPLY:</a>
<a name="ln697">			return false;</a>
<a name="ln698">		// node monitoring</a>
<a name="ln699">		case NODE_MONITORING_EVENT_REQUEST:</a>
<a name="ln700">			return true;</a>
<a name="ln701">		case NODE_MONITORING_EVENT_REPLY:</a>
<a name="ln702">			return false;</a>
<a name="ln703"> </a>
<a name="ln704">		// userland -&gt; kernel requests</a>
<a name="ln705">		// notifications</a>
<a name="ln706">		case NOTIFY_LISTENER_REQUEST:</a>
<a name="ln707">		case NOTIFY_SELECT_EVENT_REQUEST:</a>
<a name="ln708">		case NOTIFY_QUERY_REQUEST:</a>
<a name="ln709">			return false;</a>
<a name="ln710">		case NOTIFY_LISTENER_REPLY:</a>
<a name="ln711">		case NOTIFY_SELECT_EVENT_REPLY:</a>
<a name="ln712">		case NOTIFY_QUERY_REPLY:</a>
<a name="ln713">			return true;</a>
<a name="ln714">		// vnodes</a>
<a name="ln715">		case GET_VNODE_REQUEST:</a>
<a name="ln716">		case PUT_VNODE_REQUEST:</a>
<a name="ln717">		case ACQUIRE_VNODE_REQUEST:</a>
<a name="ln718">		case NEW_VNODE_REQUEST:</a>
<a name="ln719">		case PUBLISH_VNODE_REQUEST:</a>
<a name="ln720">		case REMOVE_VNODE_REQUEST:</a>
<a name="ln721">		case UNREMOVE_VNODE_REQUEST:</a>
<a name="ln722">		case GET_VNODE_REMOVED_REQUEST:</a>
<a name="ln723">			return false;</a>
<a name="ln724">		case GET_VNODE_REPLY:</a>
<a name="ln725">		case PUT_VNODE_REPLY:</a>
<a name="ln726">		case ACQUIRE_VNODE_REPLY:</a>
<a name="ln727">		case NEW_VNODE_REPLY:</a>
<a name="ln728">		case PUBLISH_VNODE_REPLY:</a>
<a name="ln729">		case REMOVE_VNODE_REPLY:</a>
<a name="ln730">		case UNREMOVE_VNODE_REPLY:</a>
<a name="ln731">		case GET_VNODE_REMOVED_REPLY:</a>
<a name="ln732">			return true;</a>
<a name="ln733">		// file cache</a>
<a name="ln734">		case FILE_CACHE_CREATE_REQUEST:</a>
<a name="ln735">		case FILE_CACHE_DELETE_REQUEST:</a>
<a name="ln736">		case FILE_CACHE_SET_ENABLED_REQUEST:</a>
<a name="ln737">		case FILE_CACHE_SET_SIZE_REQUEST:</a>
<a name="ln738">		case FILE_CACHE_SYNC_REQUEST:</a>
<a name="ln739">		case FILE_CACHE_READ_REQUEST:</a>
<a name="ln740">		case FILE_CACHE_WRITE_REQUEST:</a>
<a name="ln741">			return false;</a>
<a name="ln742">		case FILE_CACHE_CREATE_REPLY:</a>
<a name="ln743">		case FILE_CACHE_DELETE_REPLY:</a>
<a name="ln744">		case FILE_CACHE_SET_ENABLED_REPLY:</a>
<a name="ln745">		case FILE_CACHE_SET_SIZE_REPLY:</a>
<a name="ln746">		case FILE_CACHE_SYNC_REPLY:</a>
<a name="ln747">		case FILE_CACHE_READ_REPLY:</a>
<a name="ln748">		case FILE_CACHE_WRITE_REPLY:</a>
<a name="ln749">			return true;</a>
<a name="ln750">		// I/O</a>
<a name="ln751">		case DO_ITERATIVE_FD_IO_REQUEST:</a>
<a name="ln752">		case READ_FROM_IO_REQUEST_REQUEST:</a>
<a name="ln753">		case WRITE_TO_IO_REQUEST_REQUEST:</a>
<a name="ln754">		case NOTIFY_IO_REQUEST_REQUEST:</a>
<a name="ln755">			return false;</a>
<a name="ln756">		case DO_ITERATIVE_FD_IO_REPLY:</a>
<a name="ln757">		case NOTIFY_IO_REQUEST_REPLY:</a>
<a name="ln758">		case READ_FROM_IO_REQUEST_REPLY:</a>
<a name="ln759">		case WRITE_TO_IO_REQUEST_REPLY:</a>
<a name="ln760">			return true;</a>
<a name="ln761">		// node monitoring</a>
<a name="ln762">		case ADD_NODE_LISTENER_REQUEST:</a>
<a name="ln763">		case REMOVE_NODE_LISTENER_REQUEST:</a>
<a name="ln764">			return false;</a>
<a name="ln765">		case ADD_NODE_LISTENER_REPLY:</a>
<a name="ln766">		case REMOVE_NODE_LISTENER_REPLY:</a>
<a name="ln767">			return true;</a>
<a name="ln768"> </a>
<a name="ln769">		// general reply</a>
<a name="ln770">		case RECEIPT_ACK_REPLY:</a>
<a name="ln771">			return true;</a>
<a name="ln772">		default:</a>
<a name="ln773">			return false;</a>
<a name="ln774">	}</a>
<a name="ln775">}</a>
<a name="ln776"> </a>
<a name="ln777">// is_userland_request</a>
<a name="ln778">bool</a>
<a name="ln779">UserlandFSUtil::is_userland_request(uint32 type)</a>
<a name="ln780">{</a>
<a name="ln781">	switch (type) {</a>
<a name="ln782">		// kernel -&gt; userland requests</a>
<a name="ln783">		// administrative</a>
<a name="ln784">		case UFS_DISCONNECT_REQUEST:</a>
<a name="ln785">		case FS_CONNECT_REQUEST:</a>
<a name="ln786">			return false;</a>
<a name="ln787">		case FS_CONNECT_REPLY:</a>
<a name="ln788">			return true;</a>
<a name="ln789">		// FS</a>
<a name="ln790">		case MOUNT_VOLUME_REQUEST:</a>
<a name="ln791">		case UNMOUNT_VOLUME_REQUEST:</a>
<a name="ln792">//		case INITIALIZE_VOLUME_REQUEST:</a>
<a name="ln793">		case SYNC_VOLUME_REQUEST:</a>
<a name="ln794">		case READ_FS_INFO_REQUEST:</a>
<a name="ln795">		case WRITE_FS_INFO_REQUEST:</a>
<a name="ln796">			return false;</a>
<a name="ln797">		case MOUNT_VOLUME_REPLY:</a>
<a name="ln798">		case UNMOUNT_VOLUME_REPLY:</a>
<a name="ln799">//		case INITIALIZE_VOLUME_REPLY:</a>
<a name="ln800">		case SYNC_VOLUME_REPLY:</a>
<a name="ln801">		case READ_FS_INFO_REPLY:</a>
<a name="ln802">		case WRITE_FS_INFO_REPLY:</a>
<a name="ln803">			return true;</a>
<a name="ln804">		// vnodes</a>
<a name="ln805">		case LOOKUP_REQUEST:</a>
<a name="ln806">		case GET_VNODE_NAME_REQUEST:</a>
<a name="ln807">		case READ_VNODE_REQUEST:</a>
<a name="ln808">		case WRITE_VNODE_REQUEST:</a>
<a name="ln809">		case FS_REMOVE_VNODE_REQUEST:</a>
<a name="ln810">			return false;</a>
<a name="ln811">		case LOOKUP_REPLY:</a>
<a name="ln812">		case GET_VNODE_NAME_REPLY:</a>
<a name="ln813">		case READ_VNODE_REPLY:</a>
<a name="ln814">		case WRITE_VNODE_REPLY:</a>
<a name="ln815">		case FS_REMOVE_VNODE_REPLY:</a>
<a name="ln816">			return true;</a>
<a name="ln817">		// asynchronous I/O</a>
<a name="ln818">		case DO_IO_REQUEST:</a>
<a name="ln819">		case CANCEL_IO_REQUEST:</a>
<a name="ln820">		case ITERATIVE_IO_GET_VECS_REQUEST:</a>
<a name="ln821">		case ITERATIVE_IO_FINISHED_REQUEST:</a>
<a name="ln822">			return false;</a>
<a name="ln823">		case DO_IO_REPLY:</a>
<a name="ln824">		case CANCEL_IO_REPLY:</a>
<a name="ln825">		case ITERATIVE_IO_GET_VECS_REPLY:</a>
<a name="ln826">		case ITERATIVE_IO_FINISHED_REPLY:</a>
<a name="ln827">			return true;</a>
<a name="ln828">		// nodes</a>
<a name="ln829">		case IOCTL_REQUEST:</a>
<a name="ln830">		case SET_FLAGS_REQUEST:</a>
<a name="ln831">		case SELECT_REQUEST:</a>
<a name="ln832">		case DESELECT_REQUEST:</a>
<a name="ln833">		case FSYNC_REQUEST:</a>
<a name="ln834">		case READ_SYMLINK_REQUEST:</a>
<a name="ln835">		case CREATE_SYMLINK_REQUEST:</a>
<a name="ln836">		case LINK_REQUEST:</a>
<a name="ln837">		case UNLINK_REQUEST:</a>
<a name="ln838">		case RENAME_REQUEST:</a>
<a name="ln839">		case ACCESS_REQUEST:</a>
<a name="ln840">		case READ_STAT_REQUEST:</a>
<a name="ln841">		case WRITE_STAT_REQUEST:</a>
<a name="ln842">			return false;</a>
<a name="ln843">		case IOCTL_REPLY:</a>
<a name="ln844">		case SET_FLAGS_REPLY:</a>
<a name="ln845">		case SELECT_REPLY:</a>
<a name="ln846">		case DESELECT_REPLY:</a>
<a name="ln847">		case FSYNC_REPLY:</a>
<a name="ln848">		case READ_SYMLINK_REPLY:</a>
<a name="ln849">		case CREATE_SYMLINK_REPLY:</a>
<a name="ln850">		case LINK_REPLY:</a>
<a name="ln851">		case UNLINK_REPLY:</a>
<a name="ln852">		case RENAME_REPLY:</a>
<a name="ln853">		case ACCESS_REPLY:</a>
<a name="ln854">		case READ_STAT_REPLY:</a>
<a name="ln855">		case WRITE_STAT_REPLY:</a>
<a name="ln856">			return true;</a>
<a name="ln857">		// files</a>
<a name="ln858">		case CREATE_REQUEST:</a>
<a name="ln859">		case OPEN_REQUEST:</a>
<a name="ln860">		case CLOSE_REQUEST:</a>
<a name="ln861">		case FREE_COOKIE_REQUEST:</a>
<a name="ln862">		case READ_REQUEST:</a>
<a name="ln863">		case WRITE_REQUEST:</a>
<a name="ln864">			return false;</a>
<a name="ln865">		case CREATE_REPLY:</a>
<a name="ln866">		case OPEN_REPLY:</a>
<a name="ln867">		case CLOSE_REPLY:</a>
<a name="ln868">		case FREE_COOKIE_REPLY:</a>
<a name="ln869">		case READ_REPLY:</a>
<a name="ln870">		case WRITE_REPLY:</a>
<a name="ln871">			return true;</a>
<a name="ln872">		// directories</a>
<a name="ln873">		case CREATE_DIR_REQUEST:</a>
<a name="ln874">		case REMOVE_DIR_REQUEST:</a>
<a name="ln875">		case OPEN_DIR_REQUEST:</a>
<a name="ln876">		case CLOSE_DIR_REQUEST:</a>
<a name="ln877">		case FREE_DIR_COOKIE_REQUEST:</a>
<a name="ln878">		case READ_DIR_REQUEST:</a>
<a name="ln879">		case REWIND_DIR_REQUEST:</a>
<a name="ln880">			return false;</a>
<a name="ln881">		case CREATE_DIR_REPLY:</a>
<a name="ln882">		case REMOVE_DIR_REPLY:</a>
<a name="ln883">		case OPEN_DIR_REPLY:</a>
<a name="ln884">		case CLOSE_DIR_REPLY:</a>
<a name="ln885">		case FREE_DIR_COOKIE_REPLY:</a>
<a name="ln886">		case READ_DIR_REPLY:</a>
<a name="ln887">		case REWIND_DIR_REPLY:</a>
<a name="ln888">			return true;</a>
<a name="ln889">		// attribute directories</a>
<a name="ln890">		case OPEN_ATTR_DIR_REQUEST:</a>
<a name="ln891">		case CLOSE_ATTR_DIR_REQUEST:</a>
<a name="ln892">		case FREE_ATTR_DIR_COOKIE_REQUEST:</a>
<a name="ln893">		case READ_ATTR_DIR_REQUEST:</a>
<a name="ln894">		case REWIND_ATTR_DIR_REQUEST:</a>
<a name="ln895">			return false;</a>
<a name="ln896">		case OPEN_ATTR_DIR_REPLY:</a>
<a name="ln897">		case CLOSE_ATTR_DIR_REPLY:</a>
<a name="ln898">		case FREE_ATTR_DIR_COOKIE_REPLY:</a>
<a name="ln899">		case READ_ATTR_DIR_REPLY:</a>
<a name="ln900">		case REWIND_ATTR_DIR_REPLY:</a>
<a name="ln901">			return true;</a>
<a name="ln902">		// attributes</a>
<a name="ln903">		case CREATE_ATTR_REQUEST:</a>
<a name="ln904">		case OPEN_ATTR_REQUEST:</a>
<a name="ln905">		case CLOSE_ATTR_REQUEST:</a>
<a name="ln906">		case FREE_ATTR_COOKIE_REQUEST:</a>
<a name="ln907">		case READ_ATTR_REQUEST:</a>
<a name="ln908">		case WRITE_ATTR_REQUEST:</a>
<a name="ln909">		case RENAME_ATTR_REQUEST:</a>
<a name="ln910">		case READ_ATTR_STAT_REQUEST:</a>
<a name="ln911">		case WRITE_ATTR_STAT_REQUEST:</a>
<a name="ln912">		case REMOVE_ATTR_REQUEST:</a>
<a name="ln913">			return false;</a>
<a name="ln914">		case CREATE_ATTR_REPLY:</a>
<a name="ln915">		case OPEN_ATTR_REPLY:</a>
<a name="ln916">		case CLOSE_ATTR_REPLY:</a>
<a name="ln917">		case FREE_ATTR_COOKIE_REPLY:</a>
<a name="ln918">		case READ_ATTR_REPLY:</a>
<a name="ln919">		case WRITE_ATTR_REPLY:</a>
<a name="ln920">		case READ_ATTR_STAT_REPLY:</a>
<a name="ln921">		case WRITE_ATTR_STAT_REPLY:</a>
<a name="ln922">		case RENAME_ATTR_REPLY:</a>
<a name="ln923">		case REMOVE_ATTR_REPLY:</a>
<a name="ln924">			return true;</a>
<a name="ln925">		// indices</a>
<a name="ln926">		case OPEN_INDEX_DIR_REQUEST:</a>
<a name="ln927">		case CLOSE_INDEX_DIR_REQUEST:</a>
<a name="ln928">		case FREE_INDEX_DIR_COOKIE_REQUEST:</a>
<a name="ln929">		case READ_INDEX_DIR_REQUEST:</a>
<a name="ln930">		case REWIND_INDEX_DIR_REQUEST:</a>
<a name="ln931">		case CREATE_INDEX_REQUEST:</a>
<a name="ln932">		case REMOVE_INDEX_REQUEST:</a>
<a name="ln933">		case READ_INDEX_STAT_REQUEST:</a>
<a name="ln934">			return false;</a>
<a name="ln935">		case OPEN_INDEX_DIR_REPLY:</a>
<a name="ln936">		case CLOSE_INDEX_DIR_REPLY:</a>
<a name="ln937">		case FREE_INDEX_DIR_COOKIE_REPLY:</a>
<a name="ln938">		case READ_INDEX_DIR_REPLY:</a>
<a name="ln939">		case REWIND_INDEX_DIR_REPLY:</a>
<a name="ln940">		case CREATE_INDEX_REPLY:</a>
<a name="ln941">		case REMOVE_INDEX_REPLY:</a>
<a name="ln942">		case READ_INDEX_STAT_REPLY:</a>
<a name="ln943">			return true;</a>
<a name="ln944">		// queries</a>
<a name="ln945">		case OPEN_QUERY_REQUEST:</a>
<a name="ln946">		case CLOSE_QUERY_REQUEST:</a>
<a name="ln947">		case FREE_QUERY_COOKIE_REQUEST:</a>
<a name="ln948">		case READ_QUERY_REQUEST:</a>
<a name="ln949">		case REWIND_QUERY_REQUEST:</a>
<a name="ln950">			return false;</a>
<a name="ln951">		case OPEN_QUERY_REPLY:</a>
<a name="ln952">		case CLOSE_QUERY_REPLY:</a>
<a name="ln953">		case FREE_QUERY_COOKIE_REPLY:</a>
<a name="ln954">		case READ_QUERY_REPLY:</a>
<a name="ln955">		case REWIND_QUERY_REPLY:</a>
<a name="ln956">			return true;</a>
<a name="ln957">		// node monitoring</a>
<a name="ln958">		case NODE_MONITORING_EVENT_REQUEST:</a>
<a name="ln959">			return false;</a>
<a name="ln960">		case NODE_MONITORING_EVENT_REPLY:</a>
<a name="ln961">			return true;</a>
<a name="ln962"> </a>
<a name="ln963">		// userland -&gt; kernel requests</a>
<a name="ln964">		// notifications</a>
<a name="ln965">		case NOTIFY_LISTENER_REQUEST:</a>
<a name="ln966">		case NOTIFY_SELECT_EVENT_REQUEST:</a>
<a name="ln967">		case NOTIFY_QUERY_REQUEST:</a>
<a name="ln968">			return true;</a>
<a name="ln969">		case NOTIFY_LISTENER_REPLY:</a>
<a name="ln970">		case NOTIFY_SELECT_EVENT_REPLY:</a>
<a name="ln971">		case NOTIFY_QUERY_REPLY:</a>
<a name="ln972">			return false;</a>
<a name="ln973">		// vnodes</a>
<a name="ln974">		case GET_VNODE_REQUEST:</a>
<a name="ln975">		case PUT_VNODE_REQUEST:</a>
<a name="ln976">		case ACQUIRE_VNODE_REQUEST:</a>
<a name="ln977">		case NEW_VNODE_REQUEST:</a>
<a name="ln978">		case PUBLISH_VNODE_REQUEST:</a>
<a name="ln979">		case REMOVE_VNODE_REQUEST:</a>
<a name="ln980">		case UNREMOVE_VNODE_REQUEST:</a>
<a name="ln981">		case GET_VNODE_REMOVED_REQUEST:</a>
<a name="ln982">			return true;</a>
<a name="ln983">		case GET_VNODE_REPLY:</a>
<a name="ln984">		case PUT_VNODE_REPLY:</a>
<a name="ln985">		case ACQUIRE_VNODE_REPLY:</a>
<a name="ln986">		case NEW_VNODE_REPLY:</a>
<a name="ln987">		case PUBLISH_VNODE_REPLY:</a>
<a name="ln988">		case REMOVE_VNODE_REPLY:</a>
<a name="ln989">		case UNREMOVE_VNODE_REPLY:</a>
<a name="ln990">		case GET_VNODE_REMOVED_REPLY:</a>
<a name="ln991">			return false;</a>
<a name="ln992">		// file cache</a>
<a name="ln993">		case FILE_CACHE_CREATE_REQUEST:</a>
<a name="ln994">		case FILE_CACHE_DELETE_REQUEST:</a>
<a name="ln995">		case FILE_CACHE_SET_ENABLED_REQUEST:</a>
<a name="ln996">		case FILE_CACHE_SET_SIZE_REQUEST:</a>
<a name="ln997">		case FILE_CACHE_SYNC_REQUEST:</a>
<a name="ln998">		case FILE_CACHE_READ_REQUEST:</a>
<a name="ln999">		case FILE_CACHE_WRITE_REQUEST:</a>
<a name="ln1000">			return true;</a>
<a name="ln1001">		case FILE_CACHE_CREATE_REPLY:</a>
<a name="ln1002">		case FILE_CACHE_DELETE_REPLY:</a>
<a name="ln1003">		case FILE_CACHE_SET_ENABLED_REPLY:</a>
<a name="ln1004">		case FILE_CACHE_SET_SIZE_REPLY:</a>
<a name="ln1005">		case FILE_CACHE_SYNC_REPLY:</a>
<a name="ln1006">		case FILE_CACHE_READ_REPLY:</a>
<a name="ln1007">		case FILE_CACHE_WRITE_REPLY:</a>
<a name="ln1008">			return false;</a>
<a name="ln1009">		// I/O</a>
<a name="ln1010">		case DO_ITERATIVE_FD_IO_REQUEST:</a>
<a name="ln1011">		case NOTIFY_IO_REQUEST_REQUEST:</a>
<a name="ln1012">		case READ_FROM_IO_REQUEST_REQUEST:</a>
<a name="ln1013">		case WRITE_TO_IO_REQUEST_REQUEST:</a>
<a name="ln1014">			return true;</a>
<a name="ln1015">		case DO_ITERATIVE_FD_IO_REPLY:</a>
<a name="ln1016">		case NOTIFY_IO_REQUEST_REPLY:</a>
<a name="ln1017">		case READ_FROM_IO_REQUEST_REPLY:</a>
<a name="ln1018">		case WRITE_TO_IO_REQUEST_REPLY:</a>
<a name="ln1019">			return false;</a>
<a name="ln1020">		// node monitoring</a>
<a name="ln1021">		case ADD_NODE_LISTENER_REQUEST:</a>
<a name="ln1022">		case REMOVE_NODE_LISTENER_REQUEST:</a>
<a name="ln1023">			return true;</a>
<a name="ln1024">		case ADD_NODE_LISTENER_REPLY:</a>
<a name="ln1025">		case REMOVE_NODE_LISTENER_REPLY:</a>
<a name="ln1026">			return false;</a>
<a name="ln1027"> </a>
<a name="ln1028">		// general reply</a>
<a name="ln1029">		case RECEIPT_ACK_REPLY:</a>
<a name="ln1030">			return true;</a>
<a name="ln1031">		default:</a>
<a name="ln1032">			return false;</a>
<a name="ln1033">	}</a>
<a name="ln1034">}</a>

</code></pre>
<div class="balloon" rel="408"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: fSuccess.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
